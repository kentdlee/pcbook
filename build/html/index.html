<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapther 1: Introduction &mdash; Parallel Programming  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> Parallel Programming
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Chapther 1: Introduction</a><ul>
<li><a class="reference internal" href="#what-parallel-programs-can-t-do">What Parallel Programs Can’t Do</a></li>
<li><a class="reference internal" href="#parallel-applications">Parallel Applications</a><ul>
<li><a class="reference internal" href="#nuclear-fusion">Nuclear Fusion</a></li>
<li><a class="reference internal" href="#covid-19">Covid-19</a></li>
<li><a class="reference internal" href="#cfd-simulations">CFD Simulations</a></li>
<li><a class="reference internal" href="#ai">AI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-summary">Chapter Summary</a></li>
<li><a class="reference internal" href="#review-questions">Review Questions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-2-computer-architecture">Chapter 2: Computer Architecture</a><ul>
<li><a class="reference internal" href="#multitasking-and-multiprocessing">Multitasking and Multiprocessing</a></li>
<li><a class="reference internal" href="#pipelining">Pipelining</a></li>
<li><a class="reference internal" href="#caching">Caching</a><ul>
<li><a class="reference internal" href="#cache-types">Cache Types</a></li>
<li><a class="reference internal" href="#direct-mapped-and-associative-caches">Direct-Mapped and Associative Caches</a></li>
<li><a class="reference internal" href="#writing-values">Writing Values</a></li>
</ul>
</li>
<li><a class="reference internal" href="#atomicity">Atomicity</a></li>
<li><a class="reference internal" href="#virtual-memory">Virtual Memory</a></li>
<li><a class="reference internal" href="#numa">NUMA</a></li>
<li><a class="reference internal" href="#distributed-vs-shared-memory-computing">Distributed vs Shared Memory Computing</a></li>
<li><a class="reference internal" href="#interconnection-networks">Interconnection Networks</a></li>
<li><a class="reference internal" href="#id19">Chapter Summary</a></li>
<li><a class="reference internal" href="#id20">Review Questions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-3-python">Chapter 3: Python</a><ul>
<li><a class="reference internal" href="#chapter-goals">Chapter Goals</a></li>
<li><a class="reference internal" href="#creating-objects">Creating Objects</a><ul>
<li><a class="reference internal" href="#literal-values">Literal Values</a></li>
<li><a class="reference internal" href="#non-literal-object-creation">Non-Literal Object Creation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calling-methods-on-objects">Calling Methods on Objects</a></li>
<li><a class="reference internal" href="#implementing-a-class">Implementing a Class</a><ul>
<li><a class="reference internal" href="#creating-objects-and-calling-methods">Creating Objects and Calling Methods</a></li>
<li><a class="reference internal" href="#the-dog-class">The Dog Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operator-overloading">Operator Overloading</a><ul>
<li><a class="reference internal" href="#the-dog-class-with-overloaded-addition">The Dog Class with Overloaded Addition</a></li>
<li><a class="reference internal" href="#python-operator-magic-methods">Python Operator Magic Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#importing-modules">Importing Modules</a></li>
<li><a class="reference internal" href="#indentation-in-python-programs">Indentation in Python Programs</a></li>
<li><a class="reference internal" href="#the-main-function">The <em>main</em> Function</a><ul>
<li><a class="reference internal" href="#python-program-structure">Python Program Structure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reading-from-a-file">Reading From a File</a><ul>
<li><a class="reference internal" href="#a-text-file-with-single-line-records">A Text File with Single Line Records</a></li>
<li><a class="reference internal" href="#reading-and-processing-single-line-records">Reading and Processing Single Line Records</a></li>
<li><a class="reference internal" href="#pattern-for-reading-single-line-records-from-a-file">Pattern for Reading Single Line Records from a File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reading-multi-line-records-from-a-file">Reading Multi-line Records from a File</a><ul>
<li><a class="reference internal" href="#a-text-file-with-multiple-line-records">A Text File with Multiple Line Records</a></li>
<li><a class="reference internal" href="#reading-and-processing-multi-line-records">Reading and Processing Multi-Line Records</a></li>
<li><a class="reference internal" href="#pattern-for-reading-multi-line-records-from-a-file">Pattern for Reading Multi-line Records from a File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-container-class">A Container Class</a></li>
<li><a class="reference internal" href="#polymorphism">Polymorphism</a><ul>
<li><a class="reference internal" href="#graphics-command-classes">Graphics Command Classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-accumulator-pattern">The Accumulator Pattern</a><ul>
<li><a class="reference internal" href="#sum-of-squares">Sum of Squares</a></li>
<li><a class="reference internal" href="#a-graphics-program">A Graphics Program</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-a-gui-with-tkinter">Implementing a GUI with Tkinter</a><ul>
<li><a class="reference internal" href="#a-gui-drawing-application">A GUI Drawing Application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#xml-files">XML Files</a><ul>
<li><a class="reference internal" href="#the-truck-xml-file">The Truck XML File</a></li>
<li><a class="reference internal" href="#the-gotocommand-with-xml-creation-code">The GoToCommand with XML Creation Code</a></li>
<li><a class="reference internal" href="#writing-graphics-commands-to-an-xml-file">Writing Graphics Commands to an XML File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reading-xml-files">Reading XML Files</a><ul>
<li><a class="reference internal" href="#using-an-xml-parser">Using an XML Parser</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id21">Chapter Summary</a></li>
<li><a class="reference internal" href="#id22">Review Questions</a></li>
<li><a class="reference internal" href="#programming-problems">Programming Problems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-4-programming-models">Chapter 4: Programming Models</a><ul>
<li><a class="reference internal" href="#the-run-time-stack-and-heap">The Run-time Stack and Heap</a></li>
<li><a class="reference internal" href="#critical-sections">Critical Sections</a></li>
<li><a class="reference internal" href="#thread-based-parallelism">Thread-based Parallelism</a></li>
<li><a class="reference internal" href="#process-based-parallelism">Process-based Parallelism</a></li>
<li><a class="reference internal" href="#locks">Locks</a></li>
<li><a class="reference internal" href="#queues">Queues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-5-c-programming">Chapter 5: C Programming</a><ul>
<li><a class="reference internal" href="#fundamental-types">Fundamental Types</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#pointers">Pointers</a></li>
<li><a class="reference internal" href="#arrays">Arrays</a></li>
<li><a class="reference internal" href="#strings">Strings</a></li>
<li><a class="reference internal" href="#fork-join">Fork/Join</a></li>
<li><a class="reference internal" href="#atomic-instructions">Atomic Instructions</a></li>
<li><a class="reference internal" href="#debugging">Debugging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-6-posix">Chapter 6: POSIX</a><ul>
<li><a class="reference internal" href="#message-queues">Message Queues</a></li>
<li><a class="reference internal" href="#semaphores">Semaphores</a></li>
<li><a class="reference internal" href="#the-futex">The Futex</a></li>
<li><a class="reference internal" href="#shared-memory">Shared Memory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-7-shared-memory">Chapter 7: Shared Memory</a><ul>
<li><a class="reference internal" href="#id24">Locks</a></li>
<li><a class="reference internal" href="#id25">Queues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapther-8-distributed-multprocessing">Chapther 8: Distributed Multprocessing</a><ul>
<li><a class="reference internal" href="#id26">Locks</a></li>
<li><a class="reference internal" href="#id27">Queues</a></li>
<li><a class="reference internal" href="#serialization">Serialization</a></li>
<li><a class="reference internal" href="#proxies">Proxies</a></li>
<li><a class="reference internal" href="#libraries">Libraries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-9-python-multiprocessing">Chapter 9: Python Multiprocessing</a><ul>
<li><a class="reference internal" href="#the-gil">The GIL</a></li>
<li><a class="reference internal" href="#process">Process</a></li>
<li><a class="reference internal" href="#id28">Locks</a></li>
<li><a class="reference internal" href="#managers">Managers</a></li>
<li><a class="reference internal" href="#id29">Queues</a></li>
<li><a class="reference internal" href="#pool">Pool</a></li>
<li><a class="reference internal" href="#map">Map</a></li>
<li><a class="reference internal" href="#starmap">Starmap</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chapter-10-cython">Chapter 10: Cython</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Parallel Programming</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Chapther 1: Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="chapther-1-introduction">
<h1>Chapther 1: Introduction<a class="headerlink" href="#chapther-1-introduction" title="Permalink to this headline">¶</a></h1>
<p>Much is happening in the world of parallel programming. With the end of Moore’s
Law approaching and the problems we solve getting bigger, with greater amounts of
data, the need to solve problems using parallel techniques has never been
greater. In writing parallel programs it is essential that we write code that
scales well which means we have to be cognizant not only of the computational
complexity of our code, but we must also think about how to write code without
bottlenecks and with an awareness of computer architecture and how the choices
we make impact the performance of our programs.</p>
<p>This text will provide you with an introduction to parallel programming.
Important topics relating to both the big picture and the more subtle details of
parallel programming concepts and issues are presented here in a concise format.
There are many, many details that aren’t covered in this text, but after reading
this and doing exercises that are introduced in the text, you will have an
introduction to the major issues and you will have seen enough examples to be
able to learn more about parallel computation and programming through further
study.</p>
<p>The text consists of ten chapters that each introduce a new topic while building
on the material presented earlier in the text. Each chapter contains short
questions and exercises that help to check your understanding and keep you
engaged. At the end of each chapter are further, longer exercises to practice what
you learned in the chapter. When you have mastered a couple of the exercises at the
end of a chapter, you should be ready to start the next one.</p>
<p>This text assumes you have a basic understanding of Computer Science with an
introduction to programming in Python or Java and have had a Data Structures
course. The textbook doesn’t just rely on this though. Chapters within the text
introduce C and Cython programming as well so the study of this text is somewhat
intense at times and there is certainly an expectation that you may need some
supplementary sources to help. Pointers to good sources of extra information
will be referenced in the text. There is an optional chapter on C++ programming
as well.</p>
<div class="section" id="what-parallel-programs-can-t-do">
<h2>What Parallel Programs Can’t Do<a class="headerlink" href="#what-parallel-programs-can-t-do" title="Permalink to this headline">¶</a></h2>
<div class="figure align-default" id="id137">
<span id="figcomplexity"></span><img alt="_images/CommonComplexities800.png" src="_images/CommonComplexities800.png" />
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Common Computational Complexity Plots</span><a class="headerlink" href="#id137" title="Permalink to this image">¶</a></p>
</div>
<p>Computational complexity is the study of how programs perform as the amount of
data they process scales up. In <a class="reference internal" href="#figcomplexity"><span class="std std-numref">Fig. 1</span></a> you can see common
computational complexities graphed out for a visual comparison.</p>
<p>A good place to start is with confronting what parallel programming is not.
Parallel programming is not a solution to a poorly written program or an
intractable problem. For large inputs, you can’t parallelize your way out of a
problem that isn’t solvable in at least <span class="math notranslate nohighlight">\(O(n~log~n)\)</span> time. For some small
quantities of data, parallel algorithms with <span class="math notranslate nohighlight">\(O(n^2)\)</span> or worse
complexities will run faster, but they cannot scale to large amounts of data.
Anything <span class="math notranslate nohighlight">\(O(n^2)\)</span> or bigger won’t scale and would only be solvable for
small, trivial, toy problems.</p>
<p>A parallel application does not change the computational complexity of its
algorithm. Parallel computation, like sequential computation, is measured in
terms of how the time for running it scales as the data scales. Said in another
way, the speed up of parallel computation is measured in a constant, divided by
the sequential parallel computation which does not affect the computational
complexity at all.</p>
<div class="math notranslate nohighlight">
\[O(sequential(n) / constant) \equiv O(parallel(n)) \equiv O(sequential(n))\]</div>
<p>The constant can be pretty big, but it is still a constant. For instance, the
Frontier supercomputer of Oak Ridge National Laboratory contains 9,408 CPUs,
each with a capacity of 64 cores. In addition, there are 37,632 GPUs for doing
floating point calculations. Without the GPUs being factored in, that’s 602,112
cores. Each core supports 2 threads simultaneously, so that comes to 1,204,224
possible active threads of control in an application. The constant speed up
possible from a sequential application to a parallel application that does the
same computation is bounded by these numbers on Frontier.</p>
<p>While theoretically it would be possible for a sequential application to speed
up by 1,204,224 when run on Frontier, it would take a very special program that
is <em>embarrassingly parallel</em>. This is a technical term that describes a program
that has no dependencies on what other parts of the program are doing. No
<em>synchronization</em> or <em>communication</em> is necessary in an <em>embarrassingly
parallel</em> application. Other than silly example applications, these kind of
applications don’t exist in the wild.</p>
<p>All interesting parallel algorithms must communicate their results at some
point. They may also need to wait to compute their results until some action or
event occurs. Parallel applications need to <em>communicate</em> and <em>synchronize</em>. All
communication and synchronization in a program reduces the potential speedup
that parallel computation provides. At one extreme we have the <em>embarrassingly
parallel</em> algorithm. At the other extreme we have an application that needs to
be in lock step throughout its run, in which case it is not parallelizable.</p>
<p>The trick/skill in parallel programming is to discover those parts of a program
that can be independently computed and to minimize the need for
<em>synchronization</em> and <em>communication</em>. But, the lesson in this section is that
no matter how well you master this skill, the Computational Complexity of your
algorithm will not change by parallelizing it. It will only improve by some
constant factor. Nevertheless, that constant factor of improvement, might be the
difference between getting some work done in a year or getting it done in
1,204,224 years. You can see why we might be interested in parallelizing
applications!</p>
<p>So there are two primary reasons to parallelize an application. We just mentioned
one reason: we can get the work done faster. The other reason to parallelize an
application is to allow it to run on larger datasets. The motivation may be a
combination of the two as well of course. Scaling and speed are the two primary
reasons to parallelize applications.</p>
<p>In the next section, we’ll look at some applications from the world of supercomputing
to better understand the types of problems that benefit from parallel computation.</p>
</div>
<div class="section" id="parallel-applications">
<h2>Parallel Applications<a class="headerlink" href="#parallel-applications" title="Permalink to this headline">¶</a></h2>
<p>So what kinds of problems are solved by parallel algorithms? Really any problem
that can be divided into independent parts and then perhaps uses those
independent results to arrive at a final result. Sometimes people want to run
many instances of a program in parallel in what is called an <em>ensemble</em>
calcualation. In <em>ensemble</em> computation a program is run more than once because
there is some statistical nature to the calculation and running more than one
instance helps to determine an optimal solution. At other times a parallel
computation just divides up really a really large dataset into small quantities
because they can then be solved in a reasonable amount of time and the results
can be stitched back together. Let’s consider some real life examples.</p>
<div class="section" id="nuclear-fusion">
<h3>Nuclear Fusion<a class="headerlink" href="#nuclear-fusion" title="Permalink to this headline">¶</a></h3>
<p>A
<a class="reference external" href="https://www.energy.gov/science/doe-explainstokamaks#:~:text=The%20world%20record%20fusion%20power,largest%20superconducting%20magnet%20ever%20built.">tokomak</a>
is a device that shows promise to contain hot plasma that one day may create a
sustained nuclear fusion reaction. In pursuit of clean, unlimited energy there
are many experiments being conducted at a few places in the world. These
experiments, including the
<a class="reference external" href="https://www.newscientist.com/article/2336385-korean-nuclear-fusion-reactor-achieves-100-millionc-for-30-seconds/">K-Star Tokomak</a>
<span id="id1">[<a class="reference internal" href="#id131" title="G. S. Lee and the KSTAR Team. Design and construction of the kstar tokamak. Technical Report, National Fusion R&amp;D Center, Korea Basic Science Institute, Taejon, Republic of Korea, 1995. URL: https://www.osti.gov/etdeweb/servlets/purl/20261539.">LtKT95</a>]</span>, gather large quantities of data that must be analyzed to
see how they might modify the tokomak for the next experiment. Time between experiments
is critical when running the tokomak. Data analysis must be fast to give scientists maximum feedback with minimal wait. Parallel
computation is of the utmost importance <span id="id2">[<a class="reference internal" href="#id132" title="Ralph Kube. Moving fusion research into the big-and-fast data lane. Technical Report, DOE, 2020. URL: https://theory.pppl.gov/research/DOE%20Highlights/2020/DOEhighlight20200729Kube.pdf.">Kub20</a>]</span>.</p>
</div>
<div class="section" id="covid-19">
<h3>Covid-19<a class="headerlink" href="#covid-19" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://hpcwire.com">HPC Wire</a> is an excellent source of news in the world of
supercomputing. The website has a dedicated site to just the
<a class="reference external" href="https://www.hpcwire.com/2021/03/09/the-history-of-supercomputing-vs-covid-19">fight against Covid-19</a>
and all supercomputing news related to the disease.</p>
</div>
<div class="section" id="cfd-simulations">
<h3>CFD Simulations<a class="headerlink" href="#cfd-simulations" title="Permalink to this headline">¶</a></h3>
<p>In the world of Physics and engineering, understanding the world around us often
involves running simulations. Simulations are corroborated with observational
data to validate their results. The simulation itself helps us understand how
something happened. For instance, Computational Fluid Dynamics (CFD)
applications are widely used to perform fluid flow simulations. Consider the
flow of air over an airplane wing. A simulation helps predict how air will
behave given the construction of the wing. Rogers, et al., wrote an interesting
paper describing the challenges in writing a CFD for this purpose
<span id="id3">[<a class="reference internal" href="#id134" title="COMPUTATION OF VISCOUS FLOW FOR A BOEING 777 AIRCRAFT IN LANDING CONFIGURATION, 2000. URL: https://tinyurl.com/2vvp8473.">Rog00</a>]</span>. This paper is interesting because it was written during
the transition from vector processor supercomputing to today’s distributed
supercomputing. The paper provides a little insight into the challenges of and
optimizations for both architectures and mentions some early distributed
computing libraries that were used in distributed supercomputing.</p>
<p>Magnetohydrodynamic (MHD) simulation focuses on understanding how electrically
conducting fluids behave. MHD solvers are specialized versions of CFD solvers.
The concept of electrical current also applies to gravitational properties in
astrophysics. One such application, the Wombat application was written as a
scalable MHD application <span id="id4">[<a class="reference internal" href="#id133" title="P. J. Mendygral, N. Radcliffe, K. Kandalla, D. Porter, B. J. O'Neill, C. Nolting, P. Edmon, J. M. F. Donnert, and T. W. Jones. WOMBAT: a scalable and high-performance astrophysical magnetohydrodynamics code. The Astrophysical Journal Supplement Series, 228(2):23, feb 2017. URL: https://doi.org/10.3847%2F1538-4365%2Faa5b9c, doi:10.3847/1538-4365/aa5b9c.">MRK+17</a>]</span>.</p>
</div>
<div class="section" id="ai">
<h3>AI<a class="headerlink" href="#ai" title="Permalink to this headline">¶</a></h3>
<p>What is AI? It seems that AI is really all about problems we don’t understand
well. When we finally have a good grasp of how to solve a problem, it isn’t
AI anymore. Recently, the problem has been Machine Learning which presently about
training a model to recognize a pattern and then respond with an expected outcome
from its observation. So AI has become training these models to get the
expected outcomes from them. Actually running the model later on a real set of
new inputs isn’t that interesting. It is rather mechanical.</p>
<p>Getting input data, sampling input data, preparing the data for model training,
and model training itself are all tasks that can be parallelized. Consider the
Alpha Zero program. Andrew Young has an excellent article on how they parallelized
some of the Alpha Zero training <span id="id5">[<a class="reference internal" href="#id135" title="Anthony Young. Lessons from alpha zero (part 5): performance optimization. Medium.com, 2018. URL: https://medium.com/oracledevs/lessons-from-alpha-zero-part-5-performance-optimization-664b38dc509e.">You18</a>]</span>.</p>
</div>
</div>
<div class="section" id="chapter-summary">
<h2>Chapter Summary<a class="headerlink" href="#chapter-summary" title="Permalink to this headline">¶</a></h2>
<p>This chapter introduced parallel programming from an application perspective and
provides perspective on what parallel programs cannot do. A parallel version of an
application does not overcome a bad computational complexity. Parallel programs can
speed up a sequential non-parallel program only by a constant factor. Parallel versions
of programs also enable programs to run on bigger data sets than may be achievable with
sequential versions since the data is often distributed over many nodes.</p>
<p>In addition, the chapter introduces several types of HPC applications like Machine
Learning and CFD simulations includes some real life examples of those applications. Machine
learning and CFD simulations are common types of applications.</p>
</div>
<div class="section" id="review-questions">
<h2>Review Questions<a class="headerlink" href="#review-questions" title="Permalink to this headline">¶</a></h2>
<p>These are all short answer questions, but require more than one word answers. Answer
each question with a short paragraph.</p>
<ol class="arabic simple">
<li><p>Explain what a CFD application is. If you do a bit of resarch, you can
describe the details of such an algorithm in a bit more detail than is provided
in the text.</p></li>
<li><p>If a sequential program is rewritten as a parallel application and the
sequential version takes <em>X</em> time to execute, how fast will a parallel version
of it be? The point of this question is for you to qualify your answer with some
comments to demonstrate your understanding of what parallel programs can and
can’t do.</p></li>
<li><p>What were the lessons learned by the Alpha Zero project? Name at least three lessons.</p></li>
<li><p>In the struggle to control the Covid-19 pandemic, what were three contributions that
were made possible by supercomputers? Write a short paragraph for each
contribution summarizing the result and provide references for your summary.</p></li>
<li><p>This will require a bit of research. What computer system is slated to help with the
Iter Fusion work? What are some facts about this system that would be
interesting to share?</p></li>
<li><p>What supercomputers are on the Top 500 top 5 right now? Include companies and a three
interesting facts about each system.</p></li>
</ol>
</div>
</div>
<div class="section" id="chapter-2-computer-architecture">
<h1>Chapter 2: Computer Architecture<a class="headerlink" href="#chapter-2-computer-architecture" title="Permalink to this headline">¶</a></h1>
<div class="figure align-default" id="id138">
<span id="arch"></span><img alt="_images/computer.png" src="_images/computer.png" />
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Computer Architecture</span><a class="headerlink" href="#id138" title="Permalink to this image">¶</a></p>
</div>
<p>To understand how to parallelize and get the most out of performance, it is best
to know something about computer architecture. There are many architectures and
designs that differ in technical details. Fortunately, the differences are quite
technical while much of computer architecture has standardized around some
common elements. In this chapter we’ll explore those common elements, how they
work, their limitations, and how to get the most out of them in your parallel
programs.</p>
<p>This is not meant as a complete introduction to either operating systems or
computer architecture. Rather it concentrates on aspects of both operating
systems and computer architecture that can affect the performance of programs on
a system. This is intended to make the reader aware of the design and
implementation of these abstractions and hardware. The goal is to provide the
background to make wise choices when writing parallel programs and to understand
other related concepts that are not covered in this chapter. We’ll start by
talking about processes and how they are executed on a system.</p>
<div class="section" id="multitasking-and-multiprocessing">
<h2>Multitasking and Multiprocessing<a class="headerlink" href="#multitasking-and-multiprocessing" title="Permalink to this headline">¶</a></h2>
<div class="figure align-default" id="id139">
<span id="multitask"></span><img alt="_images/multitasking.png" src="_images/multitasking.png" />
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Multitasking in the OS</span><a class="headerlink" href="#id139" title="Permalink to this image">¶</a></p>
</div>
<p>All modern operating systems support <em>multitasking</em>. Multitasking is an
operating system feature where more than one process may be <em>active</em> in the OS.
On CPUs with only one core, which used to be the case, the set of active
processes were each given a timeslice for a very short amount of time, generally
a few milliseconds or less. The appearance to the user was much like looking at
a flip book for animation. It appeared that all the active processes were
running in parallel, which really wasn’t the case.</p>
<p>Many processes are waiting on I/O when they are executing. A multitasking
operation system will take advantage of that by not giving a timeslice to
processes that are waiting on I/O. Instead those processes are suspended by the
OS until the input can be read or the output can be written. We call this
blocking I/O because it blocks the process doing it until the I/O is complete.</p>
<p>The set of processes that are actually running is called the <em>active set</em> and
the <em>OS scheduler</em>, which is one of the active processes, scheduled processes in
a round-robin fashion, making sure that all active processes get a timeslice to
make them appear to keep running.</p>
<p><em>Multiprocessing</em> is when there is more than one core in the CPU or CPUs
connected to the memory and other components of a computer. Multiprocessing is
supported by the CPU and it is not an OS feature. However, support for
multiprocessing must be a part of the OS for the computer to take full advantage
of it. In a multiprocessing system more than one process is running at the same
time. The scheduler then as multiple processes all executing timeslices before
the OS switches to the next. Nothing changes in <a class="reference internal" href="#multitask"><span class="std std-numref">Fig. 3</span></a> except
that more then one process is active at any point in time.</p>
<div class="figure align-default" id="id140">
<span id="frontiernode"></span><img alt="https://docs.olcf.ornl.gov/_images/Frontier_Node_Diagram.jpg" src="https://docs.olcf.ornl.gov/_images/Frontier_Node_Diagram.jpg" />
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Frontier Node Architecture</span><a class="headerlink" href="#id140" title="Permalink to this image">¶</a></p>
</div>
<p>Many of the motherboards today for high-performance computers support two CPUs.
They have two sockets in which to seat a CPU. One CPU may have 64 cores. So
there are 128 possible cores on high-performance computer nodes. When talking
about a supercomputer they are called nodes. An Intel innovation called
Hyperthreading actually allows for two threads to execute per core. There are
some limitations to what that actually means, but it still effectively doubles
the amount of work that can be parallelized per core. Other manufacturers, like
AMD, have similar technology. While two sockets are possible on some boards, the
Frontier supercomputer has just one
<a class="reference external" href="https://tinyurl.com/4px3dkz8">CPU per node coupled with four GPUs</a> as shown
in <a class="reference internal" href="#frontiernode"><span class="std std-numref">Fig. 4</span></a>.</p>
<p>Hyperthreading means on high-performance nodes you can run up to 256
processes/threads simultaneously which would be great if you could achieve that.
This is called a theoretical maximum. It cannot be achieved, but ideally it
would be nice. On Frontier there are 128 processes possible but that must be
coupled with the work that can be carried out by each of the 4 on-node GPUs.</p>
<p>Processors can run more threads/processes than are simultaneously possible. In
that case, multitasking becomes important since there may be more than 256
processes in the active set and the scheduler will keep them moving by switching
between them. However, when there are more processes than can run
simultaneously, we say the CPU(s) have become <em>over-subscribed</em>.
Over-subscription can be a cause for <em>thrashing</em>. Thrashing occurs when
switching between processes is taking more of the resources of the computer than
the actual work getting done. You want to avoid over-subscription if possible.</p>
<p>Multitasking can slightly speed up a program’s execution because we can do work
on another process while others are waiting for I/O. Multiprocessing is where
we make bigger gains. We want our parallel programs to execute as much work in
parallel as possible and multiprocessing OS’s make that possible.</p>
</div>
<div class="section" id="pipelining">
<h2>Pipelining<a class="headerlink" href="#pipelining" title="Permalink to this headline">¶</a></h2>
<div class="figure align-default" id="id141">
<span id="pipeline"></span><img alt="_images/pipeline.png" src="_images/pipeline.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">The MIPS pipeline</span><a class="headerlink" href="#id141" title="Permalink to this image">¶</a></p>
</div>
<p>Instructions for CPUs are data and they are stored in the memory of the
computer. That was one of the things John von Neuman <span id="id6">[<a class="reference internal" href="#id41" title="Wikipedia. Von Neumann architecture. Wikipedia.org, accessed 2022. URL: https://en.wikipedia.org/wiki/Von_Neumann_architecture.">Wik22e</a>]</span>
contributed to the young field of Computer Science. All modern computers are
built around this von Neumann architecture.</p>
<p>Machines built around this fundamental principle execute instructions by first
fetching them from memory, then they decode those instructions, then they
execute them. These steps are repeated for each instruction in a program,
sometimes more than once. This repeated fetch/decode/execute is seen as a loop
and is called the fetch/decode/execute loop.</p>
<p>CPUs coordinate their execution of these stages in a CPU around a clock. An
internal clock ticks and on each tick (i.e. cycle), a new stage of the
fetch/decode/execute loop completes. The clock cycle coincides with internal
circuitry that allows results to be written to memory locations either in memory
or in hidden internal memory in the CPU.</p>
<p>In the 1990’s hardware architects like Patterson and Hennesey
<span id="id7">[<a class="reference internal" href="#id136" title="David A. Patterson and John L. Hennessy. Computer Organization and Design. Morgan Kaufmann Publishers, 2nd edition, 1998. ISBN 15-586-0428-6.">PH98</a>]</span> saw that they could define a couple more stages to the
fetch/decode/execute loop and place internal registers between the stages of
execution to allow one instruction to be in each stage of execution
simultaneously. When an instruction completes a stage, it writes its results for
that stage into the pipeline register that appears after its stage in
<a class="reference internal" href="#pipeline"><span class="std std-numref">Fig. 5</span></a>. Then it immediately starts working on the next instruction
in the previous pipeline register, or in the case of the fetch stage, a fetch is
executed on memory to get the next instruction. This is called <em>pipelining</em> in
the CPU, or <em>pipelined</em> execution.</p>
<p>Sometimes the pipeline is disrupted. This occurs when an if-statement or loop is
executed which results in executing a jump instruction in the CPU.
Knowing which instruction will be next is not possible all the time in those
situations. When that occurs, the CPU figures it out in the decode or execute
stages. In that case, the instruction has not had any side-effects yet, so it
can just be discarded and any errant instructions behind it are also discarded
and the next fetch will be from the right location, which restarts the pipeline.</p>
<p>Pipelining leads to a three to five-fold speedup of execution. We want to avoid
writing code that restarts the pipeline if possible. There are some techniques
that compilers employ to help with this in high-performance code. One of those
techniques is called <em>loop-unfolding</em> where a loop’s code is repeated some number
of times rather than jumping back to the start so the pipeline doesn’t get
restarted as often.</p>
</div>
<div class="section" id="caching">
<h2>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h2>
<p>Effective pipelining of code relies on the CPU being able to fetch an
instruction on every cycle of the CPU. In addition, if the pipeline is
disrupted, it is important to begin fetching the right instruction as soon as
possible to avoid disrupting the pipeline any longer than necessary.</p>
<p>At odds with these needs is the architecture of memory. A general rule of thumb
is the bigger then storage device, the slower the device operates for storage
and retrieval. A CPU has very limited storage. Memory can hold Gigabytes of
space. It cannot be written to or read from as fast as the CPU can execute
<span id="id8">[<a class="reference internal" href="#id43" title="Wikipedia. Memory timings. Wikipedia.org, accessed 2022. URL: https://en.wikipedia.org/wiki/Memory_timings.">Wik22c</a>]</span>. Memory operates on the clock cycle like the CPU. On a 1000GHz
system the clock cycle is 1 ns. Memory referred to as DDR3-2000 takes 7 clock
cycles from when you supply the address to when the data is available. With DDR4
it is 4 cycles to read data <span id="id9">[<a class="reference internal" href="#id47" title="System Verilog Website. DDR4 SDRAM - Understanding Timing Parameters. Systemverilog.io, accessed 2022. URL: https://www.systemverilog.io/understanding-ddr4-timing-parameters.">Web22</a>]</span>. A write to DDR4 memory needs 5
cycles to complete. To keep the pipeline running smoothly, a smaller and faster
memory, between the DDR RAM and the CPU is employed. This smaller, fast memory
is called a cache. Caches appear frequently in computer architectures. The cache
between memory and the CPU is one type of cache.</p>
<div class="section" id="cache-types">
<h3>Cache Types<a class="headerlink" href="#cache-types" title="Permalink to this headline">¶</a></h3>
<p>In fact there is more than one cache between CPU and memory. One level of cache
feeds into another. These two levels are called level 1 and level 2 cache. L1
cache resides on the CPU itself. L2 cache is typically separate from memory and
the CPU and fits between L1 and the DDR RAM. L2 cache is bigger (and hence
slower) than L1 cache.</p>
<p>Caches hold copies of data in memory. When data is read or written by the CPU it
is read from the cache and written to the cache. The goal is to always have the
data in the cache that needs to be read. Since caches are smaller than the main
memory of a computer, the computer hardware must choose which memory to have in
the cache.</p>
<p>In addition to different levels of cache, there are also separate caches for
instructions and data. Data cache is where the data of a program is copied.
Instruction caches are used by the CPU in fetching instructions.</p>
<p>And finally, recall that motherboards may have more than one socket which allows
more than one CPU to be installed. With two CPUs there would be two data caches
and two instruction caches, one for each CPU. This includes both on chip L1
cache and L2 cache between the CPU and the DDR RAM.</p>
<p>Instruction and Data caches may be tuned differently. This text covers only the
fundamentals of caching as they apply to high-performance computing and is not
meant to be a complete discussion of their design or implementation.</p>
</div>
<div class="section" id="direct-mapped-and-associative-caches">
<h3>Direct-Mapped and Associative Caches<a class="headerlink" href="#direct-mapped-and-associative-caches" title="Permalink to this headline">¶</a></h3>
<div class="figure align-default" id="id142">
<span id="directmapped"></span><img alt="_images/directmapped.png" src="_images/directmapped.png" />
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Direct-Mapped Cache</span><a class="headerlink" href="#id142" title="Permalink to this image">¶</a></p>
</div>
<p>The RAM of the computer is designed as one long continuous array of bytes. Each
byte has a unique address so that all bytes of the RAM are randomly accessible,
which means we can read from or write to any byte of memory in O(1) time, even
though it takes a few cycles to complete.</p>
<p>While not shown in the picture in <a class="reference internal" href="#directmapped"><span class="std std-numref">Fig. 6</span></a>, caches store blocks of
data of some block size. Typically in modern computers this block size, called a
<em>cache line</em>, is 64 bytes <span id="id10">[<a class="reference internal" href="#id46" title="Igor Ostrovsky. Gallery of Processor Cache Effects. Igor Ostrovsky, accessed 2022. URL: http://igoro.com/archive/gallery-of-processor-cache-effects/.">Ost22</a>]</span>. Since 64 bytes can be read in about
the same number of cycles as one byte, reading the extra data helps with
efficiency in the cache by taking advantage of <em>spatial locality</em> in a program.
Spatial locality refers to the fact that data near other recently accessed data
is more likely to be needed in the near future than other data.</p>
<p>Caches are not the size of RAM, yet have copies of RAM in them. Because they are
smaller, a cache not only stores the data, it also records the address where
that data resides in RAM. The organization of cache memory might be what is
called direct-mapped cache. In direct-mapped caches, there is one location in
the cache where a cache line can be stored. More than one 64 byte block of RAM
maps to the same block within the cache, but the cache can only hold one of
those blocks, or cache lines, at a time. For instance, in a 32K cache, the 64
bytes at address 0 would be direct mapped to the same 64 bytes in the cache as
the data at address 32K, 64K, 96K, and so on in the RAM.</p>
<div class="figure align-default" id="id143">
<span id="assocmem"></span><img alt="_images/assocmem.png" src="_images/assocmem.png" />
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Fully-Associative Cache</span><a class="headerlink" href="#id143" title="Permalink to this image">¶</a></p>
</div>
<p>On the other extreme some caches allow cache lines to be stored anywhere within
the cache memory. This type of cache is called associative memory. It features
hardware parallelism when looking up a value in cache and is therefore more
expensive. All entries are searched in parallel by the memory itself and a match
on the address returns the corresponding value in a fully-associative cache
memory.</p>
<p>There are also caches that are a combination of direct-mapped and associative.
Cache implementations have an impact on how long and how likely it is that a program’s
data will be in the cache when it needs it. But no matter what the implementation, it
is always possible to write a program that does not play nicely with the cache.</p>
<p>For instance, consider a program where you have an array and need to loop over
that array or list in your program. If you write a loop that has a step size of
64 bytes or more, then you are accessing data from different cache lines on each
iteration of that loop. This can cause you to read one item out of a cache line,
then throw it away only to want it again later. Depending on the overall size of
the cache, this may not work well with your cache.</p>
<p>If instead your program might be rewritten to loop over the contiguous elements in
order, the cache would likely be much less overwhelmed which would result in a
higher probability that the data your program needs is already present in the
cache.</p>
<p>There is a whole study of what are called cache-replacement algorithms in
associative memory. Least Recently Used (LRU) and Not Recently Used (NRU) are
two such cache replacement policies. The goal of any replacement strategy is to
maximize the <em>hits</em> on the cache (i.e. when a needed value is already in the
cache) and mimimize the <em>misses</em>. Each of these algorithms exploit some aspect
of <em>spatial</em> and/or <em>temporal</em> locality of data.</p>
<p>Knowing something about caching can help in optimizing code to get the best
performance possible. This is especially true in programs that loop over
data that is organized in some contiguous fashion. That’s when there is a
bigger chance that a cache will make a difference in execution time of a
program. Being aware of choices like how to organize data will lead to
better <em>cache friendly</em> code.</p>
</div>
<div class="section" id="writing-values">
<h3>Writing Values<a class="headerlink" href="#writing-values" title="Permalink to this headline">¶</a></h3>
<p>When the CPU writes a new value to memory, the cache must also be updated if it
contains a copy of the memory being written. Typically the CPU writes the new
data to its data cache and it up to the cache to send the new value out to
memory. Writing the value back to RAM can be done immediately when it is written
to the cache. This is called a <em>write-through</em> cache where data is written to
the cache and the write goes through immediately. The issue here is that this
doesn’t take advantage of spatial locality in the program.</p>
<p>The other possible write policy is called <em>write-back</em>. A write-back cache does
not update the RAM of the computer until the block is about to be discarded
because the cache line is being used for a different memory block. In this case,
the cache line is <em>dirty</em> and needs to be written to RAM before it is discarded.</p>
<p>Because there can be two or more data caches on a system, when one cache is written
to by a CPU it means that the other cache, if it has a copy of the same block, has
an invalid copy. To handle that one cache can signal to other caches that the block
is invalid via a cache coherence protocol <span id="id11">[<a class="reference internal" href="#id44" title="Wikipedia. Cache coherence. Wikipedia.org, accessed 2022. URL: https://en.wikipedia.org/wiki/Cache_coherence.">Wik22a</a>]</span>.</p>
<p>Cache coherence refers to the fact that all caches and memory on a computer should be
in sync in terms of their contents. If you don’t have cache coherence on a system then
special steps may need to be taken to guarantee that you can count on the values you are
using in your parallel program. That may sound a little scary, but it is less of a problem
than you might think in general. Mostly this comes into play when trying to synchronize
between processes and usually that is under some very strict rules.</p>
</div>
</div>
<div class="section" id="atomicity">
<h2>Atomicity<a class="headerlink" href="#atomicity" title="Permalink to this headline">¶</a></h2>
<p>Parallel programs sometimes need to sychronize between their processes or
threads. That synchronization typically occurs in memory that is shared between
the processes or threads. We have seen that caches introduce copies of RAM to
increase the system performance by placing data closer to the CPU in smaller,
faster memory. But the introduction of caches also introduces copies of data. In
addition, operations might think are safely executed in one step probably are
not. Firstly, pipeline processors execute instructions in multiple steps by
design. But also, something as simple as adding one to a variable is not
necessarily done in one step.</p>
<p>Operations that can be performed in one step are called <em>atomic</em> operations.
Atomic operations were so named because the atom used to be consider
indivisible. Atoms were the basic building block of matter. While we know that’s
not true now, we still use the name.</p>
<p>There is a need for atomic operations in a computer. These atomic operations are
called <em>atomic instructions</em> and CPU architectures generally support some set of
atomic operations. In the C language we have access to these atomic
instructions. For example, there is a fetch_add instruction that fetches a value
at a memory location before adding one to the value at that location.</p>
<p>There is quite a lot that happens when an atomic instruction executes. For
instance, the cache of a program that contains a copy of the memory being
updated, has that cache line invalidated so that it must be fetched from memory
again before it is used by the CPU. Atomic instructions are guaranteed atomic
across ALL the CPUs and cores of a system. Later, when C programming is
introduced we’ll revisit atomic instructions.</p>
</div>
<div class="section" id="virtual-memory">
<h2>Virtual Memory<a class="headerlink" href="#virtual-memory" title="Permalink to this headline">¶</a></h2>
<div class="figure align-default" id="id144">
<span id="virtualmem"></span><img alt="_images/virtualmem.png" src="_images/virtualmem.png" />
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">Virtual Memory Snapshot</span><a class="headerlink" href="#id144" title="Permalink to this image">¶</a></p>
</div>
<p>All modern Operating Systems and CPUs are 64-bit. The 64-bits refers to the size
of a pointer on the system. A pointer is an address of a byte in the RAM of the
system. Well, almost. There are multiple processes executing on a system, either
through multi-tasking or multi-processing or both. To protect these processes
from each other, each process has access to it’s own 64-bit address space.
Sixty-four bit pointers means that a single process can access 16,384 Petabytes!
That’s not going to happen any time soon. Instead, a process is allowed to
access areas within this immense address space. These areas are called pages.
The address space is split into pages and a process accesses its data and
program instructions in pages. While page sizes may vary between operating
systems, a typical page size is 4K.</p>
<p>Operating Systems (i.e. OS’s) and CPUs work together to support what is called
virtual memory. When a process is running, any pointer access to RAM is first
translated via what is called a <em>Translation Lookaside Buffer</em>. This TLB translation
translates between a virtual memory 64-bit pointer to a real RAM address.</p>
<p>Virtual memory allows for pages to be written to disk when they are not needed.
This is because the RAM is not big enough to hold all the programs and data for
all processes executing on the system. So, resident pages are replaceable and
the TLB is updated when one page is written to disk while another is loaded into
RAM.</p>
<p>The cool thing is that this all works without your knowledge because it is
transparent to the user. However, there are a couple things to note in passing.
Pages that are needed in RAM and are currently on disk get <em>swapped</em> into main
memory when they are needed. The operating system does this automatically and it
is called a <em>page fault</em> when the virtual address in the TLB is found to be
currently stored on disk. The virtual address page is then brought into the RAM
and potentially replaces some other virtual address page that is currently in a
physical, resident page of the RAM.</p>
<p>Page faults are bad for HPC applications because they are very slow in
comparison to accessing RAM. In other words, disks are much slower than RAM.
Once again the bigger the size of data that can be stored, the slower it is.</p>
<p>When a CPU becomes over-subscribed, meaning it is too busy, there are more and
more page faults that are generated. This can lead to the computer mostly doing
page faults to bring into RAM the <em>working set</em> of pages a process needs to
execute. When page faulting is happening so much that little other work is being
accomplished we say that the system is <em>thrashing</em>. When writing parallel
programs we don’t want to create situations where the system is thrashing. So,
we likely have to keep track of how many processes are executing and how much
memory they are using to avoid this situation. We don’t want to over-subscribe
our computer.</p>
<p>Some pages, like the OS pages in <a class="reference internal" href="#virtualmem"><span class="std std-numref">Fig. 8</span></a> may be <em>pinned</em>. A pinned
page is one that is permanently in RAM. It will still have virtual memory
addresses, but it cannot be written to disk. It is possible for user programs to
pin pages, but doing so must be done sparingly since pinning too much RAM can
lead to thrashing as well if too little memory is left for other processes.</p>
</div>
<div class="section" id="numa">
<h2>NUMA<a class="headerlink" href="#numa" title="Permalink to this headline">¶</a></h2>
<p>NUMA, or non-uniform memory access, refers to motherboards that support more
than one CPU socket. In these configurations, to allow faster access to memory
by more than one CPU, the memory may be physically split into <em>nodes</em> or <em>zones</em>
where one zone is close to one CPU and another zone is closer to another CPU
<span id="id12">[<a class="reference internal" href="#id53" title="Steve Gordon. Driving in the Fast Lane - CPU Pinning and NUMA Topology Awareness in OpenStack Compute. Redhat Blog, 2015. URL: https://www.redhat.com/en/blog/driving-fast-lane-cpu-pinning-and-numa-topology-awareness-openstack-compute.">Gor15</a>]</span>. The zones and CPUs (and their cores) are connected via an
interconnection network on the motherboard. That interconnection network
provides fast access to the CPU closest to its zone, but also enables access at
a slower speed from the other CPU socket.</p>
<div class="figure align-default" id="id145">
<span id="crossbar"></span><img alt="_images/crossbar.png" src="_images/crossbar.png" />
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">A Crossbar Interconnect</span><a class="headerlink" href="#id145" title="Permalink to this image">¶</a></p>
</div>
<p>There are many different connection topologies that are possible. A cross-bar
switch would provide simultaneous access to all cores and memory zones. NUMA
systems do not have crossbar switches because they are relatively expensive and
because they don’t scale well. Crossbar switches grow at a <span class="math notranslate nohighlight">\(O(n*m)\)</span> rate
where <em>n</em> and <em>m</em> are the number of end points. In <a class="reference internal" href="#crossbar"><span class="std std-numref">Fig. 9</span></a> everywhere
two wires cross is the location of a switch and it is the switches that grow at
the <span class="math notranslate nohighlight">\(O(n*m)\)</span> rate. As they grow at this rate, so does the failure rate.
Growth concerns in the interconnect isn’t just expense. It is also the rate of
failure, power requirements, cooling requirements, and just the motherboard or
chip real estate. There are many, many problems with architectures that don’t
scale well.</p>
<div class="figure align-default" id="id146">
<span id="numaint"></span><img alt="_images/numaint.png" src="_images/numaint.png" />
<p class="caption"><span class="caption-number">Fig. 10 </span><span class="caption-text">A NUMA Interconnect</span><a class="headerlink" href="#id146" title="Permalink to this image">¶</a></p>
</div>
<p>Instead of a crossbar interconnect, other interconnects are possible that
provide the NUMA access to memory without the growth we see with a crossbar
interconnect. For instance, without getting into too much detail,
<a class="reference internal" href="#numaint"><span class="std std-numref">Fig. 10</span></a> shows how two sockets on a motherboard might be connected to
two memory zones. In this topology, each transit through a switch (the yellow
<em>S</em> boxes) takes a unit of time. So, traveling to the local memory zone takes
just one hop, while to the other zone it takes two hops or twice as long. Both
CPUs can still access all the memory on the system. It just takes twice as long
to access a non-local memory zone. This topology conforms to the data gathered
by using the Linux command <code class="docutils literal notranslate"><span class="pre">numactl</span> <span class="pre">--hardware</span></code> in <span id="id13">[<a class="reference internal" href="#id53" title="Steve Gordon. Driving in the Fast Lane - CPU Pinning and NUMA Topology Awareness in OpenStack Compute. Redhat Blog, 2015. URL: https://www.redhat.com/en/blog/driving-fast-lane-cpu-pinning-and-numa-topology-awareness-openstack-compute.">Gor15</a>]</span>.</p>
<p>NUMA organization means that there may be some advantage to an HPC application
to have processor and data <em>affinity</em> which can help control where data and
processes are placed to maximize performance.</p>
</div>
<div class="section" id="distributed-vs-shared-memory-computing">
<h2>Distributed vs Shared Memory Computing<a class="headerlink" href="#distributed-vs-shared-memory-computing" title="Permalink to this headline">¶</a></h2>
<p>So far this chapter has concentrated on architectures that support shared memory
high-performance computing. Sharing memory between processes means that
synchronization and communication primitives based on POSIX system calls and
atomic instructions are possible. But, there are several issues with scaling up
the number of processes on a single, shared memory node.</p>
<p>One of the biggest issues is the number of cores available on a node. While
motherboards may have multiple sockets, the total number of cores is a rough
upper bound of the total number of processes that a node can support. It is
possible to run more processes than cores, especially when those processes are
I/O bound, meaning that they are often waiting on some external event or data
before they can do their work. But at some point, the number of processes that
want to run exceeds the number of available cores and the processor is
over-subscribed, meaning that no further performance gains will be realized by
adding processes. In fact, adding new processes will have a detremental affect
on performance due to the overhead of task switching and potential page swaps
which consume additional cycles.</p>
<p>Another issue can arise even before a processor becomes oversubscribed. If all
processes are accessing memory with both reads and writes, then caching becomes
less effective. High performance DRAM memory can only support two to four reads
simultaneously and up to two write locations depending on the system
architecture. Of course, more writes and reads are supported, but not
simultaneously by the memory. The system handles this by delaying simultaneous
reads and writes. Since reads and writes take multiple clock cycles, a delayed
read or write will wait until it can access the memory by stalls in the
pipeline. This is why caching is so important and when caches fail to get a
<em>hit</em> the stall will delay execution of the program. At a certain point, the
number of processes concurrently executing on a node will begin to increase the
number of stalls in the instruction pipelines.</p>
<p>Having access to shared memory is desirable and shared memory parallel programs
will have better performance than diststributed memory versions of programs when
the computer on which the program is running is not oversubscribed or
experiencing a large number of read and write conflicts. Primarily
oversubscription is the concern. To get better performance, it will be necessary
at some point to go off-node. When a parallel program runs on more than one
computer or node, it is a distributed parallel program.</p>
<p>Distributed parallel programs must communicate via message passing. The message
passing might be hidden from the programmer in the case of using a library like
SHMEM. Or it might be handled entirely by the programmer using something like
socket programming. To get the best performance, it is best not to hide the
underlying performance characteristics of the hardware since that sort of
library takes the decision making out of the hands of the programmer.</p>
<p>Consider the SHMEM library. It provides an abstraction of shared memory, but
across nodes. When programming SHMEM applications the underlying hardware
architecture is hidden behind the SHMEM abstraction. This impacts the desired
performance of SHMEM applications. Remedies were suggested, including a mixture
of MPI and SHMEM <span id="id14">[<a class="reference internal" href="#id45" title="Wikipedia. SHMEM. Wikipedia.org, accessed 2022. URL: https://en.wikipedia.org/wiki/SHMEM.">Wik22d</a>]</span>, which suggests that SHMEM by itself did
not have enough information to get the desired performance from a distributed
parallel application.</p>
<p>The art of parallel programming is designing an algorithm that scales and
performs well both on-node and off-node. It is up to the programmer to choose
relevant libraries, to understand how these libraries scale, and to use them
effectively and efficiently to solve problems. We’ll dive further into these
design choices in future chapters.</p>
</div>
<div class="section" id="interconnection-networks">
<h2>Interconnection Networks<a class="headerlink" href="#interconnection-networks" title="Permalink to this headline">¶</a></h2>
<p>Distributed applications must run over a network between nodes. A standard
ethernet network suffices for many clusters. A cluster is simply a collection of
nodes that are networked, usually by a local ethernet network. It might be the
case that such a local network is a collection of high-speed network interface
cards (i.e. NICs) connected to high-speed switches. The goal of any such network
is to minimize latency and provide good bandwidth.</p>
<p>Latency is the time it takes a message to be transmitted from one point to
another. Round-trip latency, sometimes called ping-pong latency, is a common
measure of latency in the network and can be measured by a simple ping-pong
test. Latency is important to minimize since it is a measure of how fast
messages can be transmitted between nodes in a cluster.</p>
<p>Bandwidth is a measure of how many bytes can be transmitted in a unit of some.
It’s usually measured in bytes per second. Bandwidth in a parallel application
is important when distributing larger amounts of work from one node to another.
It is a measure of how much information can flow between two nodes at anyone one
time and may involve multiple processes especially when multiple NICs are
available.</p>
<p>The network interconnect becomes very important in today’s supercomputers.
Supercomputing has evolved to be synonymous with high-performance distributed
computing. Each node in a supercomputer is typically a high core count node,
usually with access to at least one GPU. <span id="id15">[<a class="reference internal" href="#id42" title="Wikipedia. Frontier (supercomputer). Wikipedia.org, accessed 2022. URL: https://en.wikipedia.org/wiki/Frontier_(supercomputer).">Wik22b</a>]</span>. The Frontier
system has four GPUs per node. While each node is powerful in itself, the
problems today’s supercomputers are solving require coordination of multiple
nodes running on parts of the data of large problems, whether it’s AI related or
a simulation-based parallel program.</p>
<p>The interconnection network is extremely important to the overall performance of
these distributed parallel programs. While standard NICs will work,
supercomputers like Frontier employ several advanced NICs per node. Frontier’s
Cassini NIC is fast and capable of advanced data movement primitives to improve
both latency and bandwidth <span id="id16">[<a class="reference internal" href="#id51" title="Timothy Prickett Morgan. On the shortest spanning tree of a graph and the traveling salesman problem. The Next Platform, 2022. URL: https://www.nextplatform.com/2022/01/31/crays-slingshot-interconnect-is-at-the-heart-of-hpes-hpc-and-ai-ambitions.">Mor22</a>]</span>. Together with the
<em>Rosetta</em> switch, the <em>Slingshot</em> interconnect is the current premiere
interconnect in the HPC world given that exascale flops has just recently been
achieved and verified for the first time. There are other examples of fast
interconnects. Any company that wants to compete in the HPC space needs an
interconnect to connect the distributed nodes in their system. For instance,
NVidia’s interconnect is Infiniband.</p>
<p>Like all things in HPC computing, interconnects must scale and cannot create
bottlenecks. The reason that Slingshot is the premiere interconnect has a lot to
do with the fact that it can scale and support adaptive routing and congestion
control to avoid network bottlenecks <span id="id17">[<a class="reference internal" href="#id51" title="Timothy Prickett Morgan. On the shortest spanning tree of a graph and the traveling salesman problem. The Next Platform, 2022. URL: https://www.nextplatform.com/2022/01/31/crays-slingshot-interconnect-is-at-the-heart-of-hpes-hpc-and-ai-ambitions.">Mor22</a>]</span>,
<span id="id18">[<a class="reference internal" href="#id50" title="Timothy Prickett Morgan. How cray makes ethernet suited for hpc and ai with slingshot. The Next Platform, 2019. URL: https://www.nextplatform.com/2019/08/16/how-cray-makes-ethernet-suited-for-hpc-and-ai-with-slingshot.">Mor19</a>]</span>.</p>
<p>As parallel programmers we need to be aware of that our code runs in a
distributed network of nodes. Much of the actual low-level communication is done
by libraries since programming the actual inter-node communication is a complex
problem. Later in this text we’ll explore some of those libraries that help
manage off-node communication as one aspect of parallel programming.</p>
</div>
<div class="section" id="id19">
<h2>Chapter Summary<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<p>This chapter introduced many concepts in single node computer architecture. The
architectural components introduced in this chapter help inform decisions
concerning the design of parallel programs. It’s not the case that every one of
these concepts has to be remembered all the time, but understanding the
characteristics and limitations of the hardware can help with setting reasonable
goals and expectations for parallel programmers. And, when things aren’t working
as expected, having some basic understanding of the hardware can aid in
developing theories and solutions to those problems.</p>
</div>
<div class="section" id="id20">
<h2>Review Questions<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h2>
<p>These are all short answer questions, but require more than one word answers. Answer
each question with a short paragraph.</p>
<ol class="arabic simple">
<li><p>What is the difference between multitasking and multiprocessing?</p></li>
<li><p>What does the scheduler of an operating system do?</p></li>
<li><p>How can a processor run more processes than it has cores? There are two
answers to this question.</p></li>
<li><p>What is thrashing and is that something we want to avoid or try to attain?</p></li>
<li><p>What is a pipeline in computer architecture? How does it speed up the exeution
of programs?</p></li>
<li><p>In terms of the pipeline, why are jump and branch instructions a bad thing?</p></li>
<li><p>How can loop unfolding help increase program performance?</p></li>
<li><p>Caches have hits and misses. Explain these two terms.</p></li>
<li><p>Why are caches important to program performance?</p></li>
<li><p>What is a cache line? How does that term relate to performance of a program?</p></li>
<li><p>How can each process in a computer or node have access to way more memory than the RAM of the
computer? What mechanism makes this possible? Explain with a short paragraph.</p></li>
<li><p>What makes it possible for a process to reliably synchronize with other processes running on the
computer? Can you think about how two processes might synchronize with each other to work together
to count to 100?</p></li>
<li><p>What does NUMA mean in terms of memory access from your program?</p></li>
<li><p>How does distributed computing differ from on-node computation? What does the
distinction mean in terms of your program?</p></li>
<li><p>What is Slingshot? What is its topology? Why is it one of the premiere
interconnects available today?</p></li>
</ol>
</div>
</div>
<div class="section" id="chapter-3-python">
<h1>Chapter 3: Python<a class="headerlink" href="#chapter-3-python" title="Permalink to this headline">¶</a></h1>
<p>This chapter further develops  skills you learned in your first
CS course and adds to your bag of tricks by teaching you how to use
efficient algorithms for dealing with large amounts of data. Without the proper
understanding of efficiency, it is possible to bring even the fastest computers
to a grinding halt when working with large data sets. This has happened before,
and soon you will understand just how easy it can happen. But first, we’ll
review some patterns for programming and look at the Python programming language
to make sure you understand the basic structure and syntax of the language.</p>
<p>There are some general concepts about Python that you should know. Python is an
interpreted language. That means that you don’t have to go through any extra
steps after writing Python code before you can run it. Typing
<cite>python &lt;progname&gt;</cite> will run your program. Python is also dynamically typed.
This means that you will not get any type errors before you run your program as
you would with some programming languages. It is especially important for you to
understand the types of data you are using in your program. More on this in just
a bit. Finally, your Python programs are interpreted by the Python interpreter.
The REPL (i.e. Read, Evaluate, Print Loop) is another name for the interactive
Python intepreter command line and VS Code gives you access to a terminal window
where you can run a Python REPL within the IDE itself. You can type Python
statements and expressions to quickly try out a snippet of code before you put
it in a program.</p>
<p>To motivate learning or reviewing Python, the chapter will develop
a simple drawing application using turtle graphics and a Graphical User
Interface (GUI) framework called Tkinter. Along the way, you’ll discover some
patterns for programming including the accumulator pattern and the loop and a
half pattern for reading records from a file. You’ll also see functions in
Python and begin to learn how to implement your own datatypes by designing and
writing a class definition.</p>
<div class="section" id="chapter-goals">
<h2>Chapter Goals<a class="headerlink" href="#chapter-goals" title="Permalink to this headline">¶</a></h2>
<p>By the end of this chapter, you should be able to answer these questions.</p>
<blockquote>
<div><ul class="simple">
<li><p>What two parts are needed for the accumulator pattern?</p></li>
<li><p>When do you need to use the loop and a half pattern for reading from a file?</p></li>
<li><p>What is the purpose of a class definition?</p></li>
<li><p>What is an object and how do we create one?</p></li>
<li><p>What is a mutator method?</p></li>
<li><p>What is an acessor method?</p></li>
<li><p>What is a widget and how does one use widgets in GUI programming?</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="creating-objects">
<h2>Creating Objects<a class="headerlink" href="#creating-objects" title="Permalink to this headline">¶</a></h2>
<p>Python is an object-oriented language. All data items in Python are objects. In
Python, data items that could be thought of as similar are named by a type or
class. The term <em>type</em> and <em>class</em> in Python are synonymous: they are two names
for the same thing. So when you read about <em>types</em> in Python you can think of
<em>classes</em> or vice versa.</p>
<p>There are several built-in types of data in Python including <em>int</em>, <em>float</em>,
<em>str</em>, <em>list</em>, and <em>dict</em> which is short for dictionary. These types of data and
their associated operations are included in the appendices at the end of the
text so you have a quick reference if you need to refer to it while programming.
You can also get help for any type by typing <em>help(typename)</em> in the Python
shell, where <em>typename</em> is a type or class in Python.</p>
<div class="section" id="literal-values">
<h3>Literal Values<a class="headerlink" href="#literal-values" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to create objects in Python. In a few cases, you can use a
literal value to create an object. Literal values are used when we want to set
some variable to a specific value within our program. For example, the literal 6
denotes any object with the integer value of 6.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
<p>This creates an <em>int</em> object containing the value 6. It also points the
reference called <em>x</em> at this object as pictured in <a class="reference internal" href="#xreffig"><span class="std std-numref">Fig. 11</span></a>. All
assignments in Python point references at objects. Any time you see an
assignment statement, you should remember that the thing on the left side of the
equals sign is a reference and the thing on the right side is either another
reference or a newly created object. In this case, writing <em>x = 6</em> makes a new
object and then points <em>x</em> at this object.</p>
<div class="figboxright docutils container">
<div class="figure align-default" id="id147">
<span id="xreffig"></span><img alt="_images/xref.png" src="_images/xref.png" />
<p class="caption"><span class="caption-number">Fig. 11 </span><span class="caption-text">A Reference and Object</span><a class="headerlink" href="#id147" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>Other literal values may be written in Python as well. Here are some literal
values that are possible in Python.</p>
<blockquote>
<div><ul class="simple">
<li><p><em>int</em> literals : 6, 3, 10, -2, etc.</p></li>
<li><p><em>float</em> literals : 6.0, -3.2, 4.5E10</p></li>
<li><p><em>str</em> literals : ‘hi there’, “how are you”</p></li>
<li><p><em>list</em> literals : [], [6, ‘hi there’]</p></li>
<li><p><em>dict</em> literals : {}, {‘hi there’:6, ‘how are you’:4}</p></li>
</ul>
</div></blockquote>
<p>Python lets you specify <em>float</em> literals with an exponent. So, <em>4.5E10</em>
represents the <em>float</em> 45000000000.0. Any number written with a decimal point is
a <em>float</em>, whether there is a 0 or some other value after the decimal point. If
you write a number using the <em>E</em> or exponent notation, it is a float as well.
Any number without a decimal point is an <em>int</em>, unless it is written in <em>E</em>
notation. String literals are surrounded by either single or double quotes. List
literals are surrounded by [ and ]. The [] literal represents the empty list.
The {} literal is the empty dictionary.</p>
<p>You may not have done a lot with dictionaries previvously. A dictionary is a
mapping of keys to values. In the dictionary literal, the key ‘hi there’ is
mapped to the value 6, and the key ‘how are you’ is mapped to 4. More
information can be found
<a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html">here</a>.</p>
</div>
<div class="section" id="non-literal-object-creation">
<h3>Non-Literal Object Creation<a class="headerlink" href="#non-literal-object-creation" title="Permalink to this headline">¶</a></h3>
<p>Most of the time, when an object is created, it is not created from a literal
value. Of course, we need literal values in programming languages, but most of
the time we have an object already and want to create another object by using
one or more existing objects. For instance, if we have a string in Python, like
‘6’ and want to create an <em>int</em> object from that string, we can do something
like the following.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;6&#39;</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>In this short piece of code, <em>y</em> is a reference to the <em>str</em> object created from
the string literal. The variable <em>x</em> is a reference to an object that is created
by using the object that <em>y</em> refers to. In general, when we want to create an
object based on other object values we write the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">other_object_values</span><span class="p">)</span>
</pre></div>
</div>
<p>The <em>type</em> is any type or class name in Python, like <em>int</em>, <em>float</em>, <em>str</em> or
any other type. The <em>other_object_values</em> is a comma-separated sequence of
references to other objects that are needed by the class or type to create an
instance (i.e an object) of that type. Here are some examples of creating
objects from non-literal values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;6.3&#39;</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="c1"># this results in the list [&#39;6&#39;, &#39;.&#39;, &#39;3&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="calling-methods-on-objects">
<span id="callingmethods"></span><h2>Calling Methods on Objects<a class="headerlink" href="#calling-methods-on-objects" title="Permalink to this headline">¶</a></h2>
<p>Objects are useful because they allow us to collect related information and
group them with behavior that act on this data. These behaviors are are called
<em>methods</em> in Python. There are two kinds of methods in any object-oriented
language: <em>mutator</em> and <em>accessor</em> methods. <em>Accessor</em> methods access the
current state of an object but don’t change the object. <em>Accessor</em> methods
return new object references when called.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;how are you&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the method <em>upper</em> is called on the object that <em>x</em> refers to. The <em>upper</em>
accessor method returns a new object, a <em>str</em> object, that is an upper-cased
version of the original string. Note that <em>x</em> is not changed by calling the
<em>upper</em> method on it. The <em>upper</em> method is an accessor method. There are many
accessor methods available on the <em>str</em> type which you can learn about in the
appendices.</p>
<p>Some methods are mutator methods. These methods actually change the existing
object. One good example of this is the <em>reverse</em> method on the <em>list</em> type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">myList</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myList</span><span class="p">)</span> <span class="c1"># This prints [3, 2, 1] to the screen</span>
</pre></div>
</div>
<p>The <em>reverse</em> method mutates the existing object, in this case the list that
<em>myList</em> refers to. Once called, a mutator method can’t be undone. The change or
mutation is permanent until mutated again by some other mutator method.</p>
<p>All classes contain accessor methods. Without accessor methods, the class would
be pretty uninteresting. We use accessor methods to retrieve a value that is
stored in an object or to retrieve a value that depends on the value stored in
an object. If a class had no accessor methods we could put values in the object
but we could never retrieve them.</p>
<p>Some classes have mutator methods and some don’t. For instance, the <em>list</em> class
has mutator methods, including the <em>reverse</em> method. There are some classes that
don’t have any mutator methods. For instance, the <em>str</em> class does not have any
mutator methods. When a class does not contain any mutator methods, we say that
the class is <em>immutable</em>. We can form new values from the data in an <em>immutable</em>
class, but once an immutable object is created, it cannot be changed. Other
immutable classes include <em>int</em> and <em>float</em>.</p>
</div>
<div class="section" id="implementing-a-class">
<h2>Implementing a Class<a class="headerlink" href="#implementing-a-class" title="Permalink to this headline">¶</a></h2>
<p>Programming in an object-oriented language usually means implementing classes
that describe objects which hold information that is needed by the program you
are writing. Objects contain data and methods operate on that data. A <em>class</em> is
the definition of the <em>data</em> and <em>methods</em> for a specific type of <em>object</em>.</p>
<p>Every class contains one special method called a constructor. The constructor’s
job is to create an instance of an object by placing references to data within
the object itself. For example, consider a class called Dog. A dog has a name, a
birthday, and a sound it makes when it barks. When we create a Dog object, we
would write something like the code appearing in <a class="reference internal" href="#creatingcalling"><span class="std std-ref">Creating Objects and Calling Methods</span></a>.</p>
<div class="section" id="creating-objects-and-calling-methods">
<span id="creatingcalling"></span><h3>Creating Objects and Calling Methods<a class="headerlink" href="#creating-objects-and-calling-methods" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">boyDog</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Mesa&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;WOOOF&quot;</span><span class="p">)</span>
<span class="n">girlDog</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Sequoia&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;barkbark&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">boyDog</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">girlDog</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">boyDog</span><span class="o">.</span><span class="n">birthDate</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">girlDog</span><span class="o">.</span><span class="n">birthDate</span><span class="p">())</span>
<span class="n">boyDog</span><span class="o">.</span><span class="n">changeBark</span><span class="p">(</span><span class="s2">&quot;woofywoofy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">boyDog</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
</pre></div>
</td></tr></table></div>
<div class="figboxright docutils container">
<div class="figure align-default" id="id148">
<span id="dogobjects"></span><img alt="_images/dogobjects.png" src="_images/dogobjects.png" />
<p class="caption"><span class="caption-number">Fig. 12 </span><span class="caption-text">A Couple of Dog Objects</span><a class="headerlink" href="#id148" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>Once created, the dog objects would look like <a class="reference internal" href="#dogobjects"><span class="std std-numref">Fig. 12</span></a> in the memory
of the computer. Each object is referenced by the variable reference assigned to
it, either <em>girlDog</em> or <em>boyDog</em> in this case. The objects themselves are a
collection of references that point to the information that is stored in the
object. Each object has a name, month, day, year, and speakText references that
point to the associated data that make up a Dog object.</p>
<p>To be able to create <em>Dog</em> objects like these two objects we need a <em>Dog</em> class
to define these objects. In addition, we’ll need to define <em>speak</em>, <em>birthDate</em>,
and <em>changeBark</em> methods. We can do this by writing a class as shown in
<a class="reference internal" href="#dogclass"><span class="std std-ref">The Dog Class</span></a>. Comments about each part of the class appear in the code. The
special variable <em>self</em> always points at the current object and must be the
first parameter to each method in the class. Python takes care of passing the
<em>self</em> argument to the methods. The other arguments are passed by the programmer
when the method is called (see the example of calling each method in
<a class="reference internal" href="#creatingcalling"><span class="std std-ref">Creating Objects and Calling Methods</span></a>).</p>
</div>
<div class="section" id="the-dog-class">
<span id="dogclass"></span><h3>The Dog Class<a class="headerlink" href="#the-dog-class" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="c1"># This is the constructor for the class. It is called whenever a Dog</span>
    <span class="c1"># object is created. The reference called &quot;self&quot; is created by Python</span>
    <span class="c1"># and made to point to the space for the newly created object. Python</span>
    <span class="c1"># does this automatically for us but we have to have &quot;self&quot; as the first</span>
    <span class="c1"># parameter to the __init__ method (i.e. the constructor).</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">speakText</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span> <span class="o">=</span> <span class="n">speakText</span>

    <span class="c1"># This is an accessor method that returns the speakText stored in the</span>
    <span class="c1"># object. Notice that &quot;self&quot; is a parameter. Every method has &quot;self&quot; as its</span>
    <span class="c1"># first parameter. The &quot;self&quot; parameter is a reference to the current</span>
    <span class="c1"># object. The current object appears on the left hand side of the dot (i.e.</span>
    <span class="c1"># the .) when the method is called.</span>
    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span>

    <span class="c1"># Here is an accessor method to get the name</span>
    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># This is another accessor method that uses the birthday information to</span>
    <span class="c1"># return a string representing the date.</span>
    <span class="k">def</span> <span class="nf">birthDate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>

    <span class="c1"># This is a mutator method that changes the speakText of the Dog object.</span>
    <span class="k">def</span> <span class="nf">changeBark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bark</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span> <span class="o">=</span> <span class="n">bark</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="operator-overloading">
<h2>Operator Overloading<a class="headerlink" href="#operator-overloading" title="Permalink to this headline">¶</a></h2>
<p>Python provides operator overloading, which is a nice feature of programming
languages because it makes it possible for the programmer to interact with
objects in a very natural way. Operator overloading is already implemented for a
variety of the built-in classes or types in Python. For instance, integers (i.e.
the <em>int</em> type) understand how they can be added together to form a new integer
object. Addition is implemented by a special method in Python called the
<em>__add__</em> method. When two integers are added together, this method is called to
create a new integer object. If you look in the appendices, you’ll see examples
of these special methods and how they are called. For example, the <em>__add__</em>
method is called by writing <em>x+y</em> where <em>x</em> is an integer. The methods that
begin and end with two underscores are methods that Python associates with a
corresponding operator.</p>
<p>When we say that Python supports operator <em>overloading</em> we mean that if you
define a method for your class with a name that is operator overloaded, your
class will support that operator as well. Python figures out which method to
call based on the types of the operands involved. For instance, writing <em>x+y</em>
calls the <em>int</em> class <em>__add__</em> method when <em>x</em> is an integer, but it calls the
<em>float</em> type’s <em>__add__</em> method when <em>x</em> is a <em>float</em>. This is because in the
case of the <em>__add__</em> method, the object on the left hand side of the <em>+</em>
operator corresponds to the object on the left hand side of the dot (i.e. the
period) in the equivalent method call <em>x.__add__(y)</em>. The object on the left
side of the dot determines which add method is called. The <em>+</em> operator is
overloaded.</p>
<p>If we wanted to define addition for our <em>Dog</em> class, we would include an
<em>__add__</em> method in the class definition. It might be natural to write <em>boyDog +
girlDog</em> to create a new puppy object. If we wished to do that we would extend
our Dog class as shown in <a class="reference internal" href="#dogoperator"><span class="std std-ref">The Dog Class with Overloaded Addition</span></a>.</p>
<div class="section" id="the-dog-class-with-overloaded-addition">
<span id="dogoperator"></span><h3>The Dog Class with Overloaded Addition<a class="headerlink" href="#the-dog-class-with-overloaded-addition" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="c1"># This is the constructor for the class. It is called whenever a Dog</span>
    <span class="c1"># object is created. The reference called &quot;self&quot; is created by Python</span>
    <span class="c1"># and made to point to the space for the newly created object. Python</span>
    <span class="c1"># does this automatically for us but we have to have &quot;self&quot; as the first</span>
    <span class="c1"># parameter to the __init__ method (i.e. the constructor).</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">speakText</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span> <span class="o">=</span> <span class="n">speakText</span>

    <span class="c1"># This is an accessor method that returns the speakText stored in the</span>
    <span class="c1"># object. Notice that &quot;self&quot; is a parameter. Every method has &quot;self&quot; as its</span>
    <span class="c1"># first parameter. The &quot;self&quot; parameter is a reference to the current</span>
    <span class="c1"># object. The current object appears on the left hand side of the dot (i.e.</span>
    <span class="c1"># the .) when the method is called.</span>
    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span>

    <span class="c1"># Here is an accessor method to get the name</span>
    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># This is another accessor method that uses the birthday information to</span>
    <span class="c1"># return a string representing the date.</span>
    <span class="k">def</span> <span class="nf">birthDate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>

    <span class="c1"># This is a mutator method that changes the speakText of the Dog object.</span>
    <span class="k">def</span> <span class="nf">changeBark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bark</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span> <span class="o">=</span> <span class="n">bark</span>

    <span class="c1"># When creating the new puppy we don&#39;t know it&#39;s birthday. Pick the</span>
    <span class="c1"># first dog&#39;s birthday plus one year. The speakText will be the</span>
    <span class="c1"># concatenation of both dog&#39;s text. The dog on the left side of the +</span>
    <span class="c1"># operator is the object referenced by the &quot;self&quot; parameter. The</span>
    <span class="c1"># &quot;otherDog&quot; parameter is the dog on the right side of the + operator.</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">otherDog</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Puppy of &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span> <span class="o">+</span> <span class="n">otherDog</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">speakText</span> <span class="o">+</span> <span class="n">otherDog</span><span class="o">.</span><span class="n">speakText</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">boyDog</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Mesa&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;WOOOOF&quot;</span><span class="p">)</span>
    <span class="n">girlDog</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Sequoia&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;barkbark&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">boyDog</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">girlDog</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">boyDog</span><span class="o">.</span><span class="n">birthDate</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">girlDog</span><span class="o">.</span><span class="n">birthDate</span><span class="p">())</span>
    <span class="n">boyDog</span><span class="o">.</span><span class="n">changeBark</span><span class="p">(</span><span class="s2">&quot;woofywoofy&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">boyDog</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
    <span class="n">puppy</span> <span class="o">=</span> <span class="n">boyDog</span> <span class="o">+</span> <span class="n">girlDog</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">puppy</span><span class="o">.</span><span class="n">speak</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">puppy</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">puppy</span><span class="o">.</span><span class="n">birthDate</span><span class="p">())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>This text uses operator overloading fairly extensively. There are many operators
that are defined in Python. Python programmers often call these operators <em>Magic
Methods</em> because a method automatically gets called when an operator is used in
an expression. Many of the common operators are given in the table in
<a class="reference internal" href="#magicmethods"><span class="std std-ref">Python Operator Magic Methods</span></a> for your convenience. For each operator the magic method is
given, how to call the operator is given, and a short description of it as well.
In the table, <em>self</em> and <em>x</em> refer to the same object. The type of <em>x</em>
determines which operator method is called in each case in the table.</p>
</div>
<div class="section" id="python-operator-magic-methods">
<span id="magicmethods"></span><h3>Python Operator Magic Methods<a class="headerlink" href="#python-operator-magic-methods" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 11%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method Defintion</p></th>
<th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__add__(self,y)</p></td>
<td><p>x + y</p></td>
<td><p>The addition of two objects. The type of <em>x</em> determines
which add operator is called.</p></td>
</tr>
<tr class="row-odd"><td><p>__contains__(self,y)</p></td>
<td><p>y in x</p></td>
<td><p>When <em>x</em> is a collection you can test to see if <em>y</em> is in it.</p></td>
</tr>
<tr class="row-even"><td><p>__eq__(self,y)</p></td>
<td><p>x == y</p></td>
<td><p>Returns <em>True</em> or <em>False</em> depending on the values of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-odd"><td><p>__ge__(self,y)</p></td>
<td><p>x &gt;= y</p></td>
<td><p>Returns <em>True</em> or <em>False</em> depending on the values of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__getitem__(self,y)</p></td>
<td><p>x[y]</p></td>
<td><p>Returns the item at the y<sup>th</sup> position in x.</p></td>
</tr>
<tr class="row-odd"><td><p>__gt__(self,y)</p></td>
<td><p>x &gt; y</p></td>
<td><p>Returns <em>True</em> or <em>False</em> depending on the values of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__hash__(self)</p></td>
<td><p>hash(x)</p></td>
<td><p>Returns an integral value for <em>x</em>.</p></td>
</tr>
<tr class="row-odd"><td><p>__int__(self)</p></td>
<td><p>int(x)</p></td>
<td><p>Returns an integer representation of <em>x</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__iter__(self)</p></td>
<td><p>for v in x</p></td>
<td><p>Returns an iterator object for the sequence <em>x</em>.</p></td>
</tr>
<tr class="row-odd"><td><p>__le__(self,y)</p></td>
<td><p>x &lt;= y</p></td>
<td><p>Returns <em>True</em> or <em>False</em> depending on the values of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__len__(self)</p></td>
<td><p>len(x)</p></td>
<td><p>Returns the size of <em>x</em> where <em>x</em> has some length attribute.</p></td>
</tr>
<tr class="row-odd"><td><p>__lt__(self,y)</p></td>
<td><p>x &lt; y</p></td>
<td><p>Returns <em>True</em> or <em>False</em> depending on the values of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__mod__(self,y)</p></td>
<td><p>x % y</p></td>
<td><p>Returns the value of <em>x</em> modulo <em>y</em>. This is the remainder of <em>x/y</em>.</p></td>
</tr>
<tr class="row-odd"><td><p>__mul__(self,y)</p></td>
<td><p>x * y</p></td>
<td><p>Returns the product of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__ne__(self,y)</p></td>
<td><p>x != y</p></td>
<td><p>Returns <em>True</em> or <em>False</em> depending on the values of <em>x</em> and <em>y</em>.</p></td>
</tr>
<tr class="row-odd"><td><p>__neg__(self)</p></td>
<td><p>-x</p></td>
<td><p>Returns the unary negation of <em>x</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__repr__(self)</p></td>
<td><p>repr(x)</p></td>
<td><p>Returns a string version of x suitable to be evaluated by the <em>eval</em> function.</p></td>
</tr>
<tr class="row-odd"><td><p>__setitem__(self,i,y)</p></td>
<td><p>x[i] = y</p></td>
<td><p>Sets the item at the i<sup>th</sup> position in <em>x</em> to <em>y</em>.</p></td>
</tr>
<tr class="row-even"><td><p>__str__(self)</p></td>
<td><p>str(x)</p></td>
<td><p>Return a string representation of <em>x</em> suitable for user-level interaction.</p></td>
</tr>
<tr class="row-odd"><td><p>__sub__(self,y)</p></td>
<td><p>x - y</p></td>
<td><p>The difference of two objects.</p></td>
</tr>
</tbody>
</table>
<p>The <em>repr(x)</em> and the <em>str(x)</em> operators deserve a little more explanation. Both
operators return a string represenation of <em>x</em>. The difference is that the <em>str</em>
operator should return a string that is suitable for human interaction while the
<em>repr</em> operator is called when a string representation is needed that can be
evaluated. For instance, if we wanted to define these two operators on the <em>Dog</em>
class, the <em>repr</em> method would return the string “Dog(‘Mesa’,5,15,2004,’WOOOF’)”
while the <em>str</em> operator might return just the dog’s name. The <em>repr</em>
opererator, when called, will treat the string as an expression that could later
be evaluated by the <em>eval</em> function in Python whereas the <em>str</em> operator simply
returns a string for an object.</p>
</div>
</div>
<div class="section" id="importing-modules">
<h2>Importing Modules<a class="headerlink" href="#importing-modules" title="Permalink to this headline">¶</a></h2>
<p>In Python, programs can be broken up into modules. Typically, when you write a
program in Python you are going to use code that someone else wrote. Code that
others wrote is usually provided in a module. To use a module, you import it.
There are two ways to import a module. For the drawing program we are developing
in this chapter, we want to use turtle graphics. Turtle graphics was first
developed a long time ago for a programming language called Logo. Logo was
created around 1967 so the basis for turtle graphics is pretty ancient in terms
of Computer Science. It still remains a useful way of thinking about Computer
Graphics. The idea is that a turtle is wandering a beach and as it walks around
it drags its tail in the sand leaving a trail behind it.
<a class="reference external" href="https://docs.python.org/3/library/turtle.html">All that you can do with a turtle is discussed here</a>.</p>
<p>There are two ways to import a module in Python: the <em>convenient</em> way and the
<em>safe</em> way. Which way you choose to import code may be a personal preference,
but there are some implications about using the <em>convenient</em> method of importing
code. The convenient way to import the turtle module would be to write the
following.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">turtle</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Turtle</span><span class="p">()</span>
</pre></div>
</div>
<p>This is convenient, because whenever you want to use the <em>Turtle</em> class, you can
just write <em>Turtle</em> which is convenient, but not completely safe because you
then have to make sure you never use the identifier <em>Turtle</em> for anything else
in your code. In fact, there may be other identifiers that the turtle module
defines that you are unaware of that would also be identifiers you should not
use in your code. The safe way to import the turtle module would be as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">turtle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">turtle</span><span class="o">.</span><span class="n">Turtle</span><span class="p">()</span>
</pre></div>
</div>
<p>While this is not quite as <em>convenient</em>, because you must precede <em>Turtle</em> with
<em>“turtle.”</em>, it is <em>safe</em> because the <em>namespace</em> of your module and the turtle
module are kept separate. All identifiers in the turtle module are in the
<em>turtle namespace</em>, while the local identifiers are in the <em>local namespace</em>.
This idea of <em>namespaces</em> is an important feature of most programming languages.
It helps programmers keep from stepping on each others’ toes. The rest of this
text will stick to using the safe method of importing modules.</p>
</div>
<div class="section" id="indentation-in-python-programs">
<h2>Indentation in Python Programs<a class="headerlink" href="#indentation-in-python-programs" title="Permalink to this headline">¶</a></h2>
<p>Indentation plays an important role in Python programs. An indented line belongs
to the line it is indented under. The <em>body</em> of a function is indented under its
function definition line. The <em>then</em> part of an <em>if</em> statement is indented under
the <em>if</em>. A <em>while</em> loop’s body is indented under it. The methods of a class are
all indented under the class defintion line. All statements that are indented
the same amount and grouped together are called a <em>block</em>. It is important that
all statements within a <em>block</em> are indented exactly the same amount. If they
are not, then Python will complain about inconsistent indentation.</p>
<div class="figboxcenter docutils container">
<div class="figure align-default" id="id149">
<span id="blockindent"></span><img alt="_images/blockindent.png" src="_images/blockindent.png" />
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">Adjusting Indentation in Wing IDE 101</span><a class="headerlink" href="#id149" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>Because indentation is so important to Python, the Wing IDE 101 lets you select
a series of lines and adjust their indentation as a group, as shown in
<a class="reference internal" href="#blockindent"><span class="std std-numref">Fig. 13</span></a>. You first select the lines of the block and then press
the <em>tab</em> key to increase their indentation. To decrease the indentation of a
block you select the lines of the block and press <em>Shift-tab</em>. As you write
Python code this is a common chore and being able to adjust the indentation of a
whole block at a time is a real timesaver.</p>
</div>
<div class="section" id="the-main-function">
<h2>The <em>main</em> Function<a class="headerlink" href="#the-main-function" title="Permalink to this headline">¶</a></h2>
<p>Programs are typically written with many function definitions and function
calls. One function definition is written by convention in Python, usually
called the <em>main</em> function. This function contains code the program typically
executes when it is first started. The general outline of a Python program is
given in <a class="reference internal" href="#mainfunction"><span class="std std-ref">Python Program Structure</span></a>.</p>
<div class="section" id="python-program-structure">
<span id="mainfunction"></span><h3>Python Program Structure<a class="headerlink" href="#python-program-structure" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Imports at the top.</span>
<span class="kn">import</span> <span class="nn">turtle</span>

<span class="c1"># other function definitions followed by the main function definition</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># The main code of the program goes here</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">turtle</span><span class="o">.</span><span class="n">Turtle</span><span class="p">()</span>

<span class="c1"># this code calls the main function to get everything started. The condition in this</span>
<span class="c1"># if statement evaluates to True when the module is executed by the interpreter, but</span>
<span class="c1"># not when it is imported into another module.</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The <em>if</em> statement at the end of the code in <a class="reference internal" href="#mainfunction"><span class="std std-ref">Python Program Structure</span></a> is the first
code executed after the import statements. The <em>if</em> statement’s condition
evaluates to <em>True</em> when the program is run as a stand-alone program. Sometimes
we write modules that we may want to import into another module. Writing this
<em>if</em> statement to call the main function makes the module execute its own main
function when it is run as a stand-alone program. When the module is imported
into another module it will not execute its main function. Later you will have
the opportunity to write a module to be imported into another module so it is a
good habit to form to always call the <em>main</em> function in this way.</p>
</div>
</div>
<div class="section" id="reading-from-a-file">
<h2>Reading From a File<a class="headerlink" href="#reading-from-a-file" title="Permalink to this headline">¶</a></h2>
<p>To begin our drawing program, let’s assume that a picture is stored in a file
and we wish to read this file when the program is started. We’ll assume that
each line of the file contains a drawing command and its associated data. We’ll
keep it simple and stick to drawing commands that look like this in the input
file:</p>
<blockquote>
<div><ul class="simple">
<li><p>goto, x, y, width, color</p></li>
<li><p>circle, radius, width, color</p></li>
<li><p>beginfill, color</p></li>
<li><p>endfill</p></li>
<li><p>penup</p></li>
<li><p>pendown</p></li>
</ul>
</div></blockquote>
<p>Each line of the file will contain a record with the needed information. We can
draw a picture by providing a file with the right sequence of these commands.
The file in <a class="reference internal" href="#singlelinerecs"><span class="std std-ref">A Text File with Single Line Records</span></a> contains records that describe a pickup truck.</p>
<div class="section" id="a-text-file-with-single-line-records">
<span id="singlelinerecs"></span><h3>A Text File with Single Line Records<a class="headerlink" href="#a-text-file-with-single-line-records" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>beginfill, black
circle, 20, 1, black
endfill
penup
goto, 120, 0, 1, black
pendown
beginfill, black
circle, 20, 1, black
endfill
penup
goto, 150, 40, 1, black
pendown
beginfill, yellow
goto, -30, 40, 1, black
goto, -30, 70, 1, black
goto, 60, 70, 1, black
goto, 60, 100, 1, black
goto, 90, 100, 1, black
goto, 115, 70, 1, black
goto, 150, 70, 1, black
goto, 150, 40, 1, black
endfill
</pre></div>
</div>
<p>To process the records in the file in <a class="reference internal" href="#singlelinerecs"><span class="std std-ref">A Text File with Single Line Records</span></a>, we can write a
Python program that reads the lines of this file and does the appropriate turtle
graphics commands for each record in the file. Since each record (i.e. drawing
command) is on its own line in the file format described in
<a class="reference internal" href="#singlelinerecs"><span class="std std-ref">A Text File with Single Line Records</span></a>, we can read the file by using a <em>for</em> loop to read the
lines of the file. The code of <a class="reference internal" href="#graphicsprograma"><span class="std std-ref">Reading and Processing Single Line Records</span></a> is a program that reads
these commands and processes each record in the file, drawing the picture that
it contains.</p>
</div>
<div class="section" id="reading-and-processing-single-line-records">
<span id="graphicsprograma"></span><h3>Reading and Processing Single Line Records<a class="headerlink" href="#reading-and-processing-single-line-records" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># This imports the turtle graphics module.</span>
<span class="kn">import</span> <span class="nn">turtle</span>

<span class="c1"># The main function is where the main code of the program is written.</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># This line reads a line of input from the user.</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter drawing filename: &quot;</span><span class="p">)</span>

    <span class="c1"># Create a Turtle Graphics window to draw in.</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">turtle</span><span class="o">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="c1"># The screen is used at the end of the program.</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">getscreen</span><span class="p">()</span>

    <span class="c1"># The next line opens the file for &quot;r&quot; or reading. &quot;w&quot; would open it for</span>
    <span class="c1"># writing, and &quot;a&quot; would open the file to append to it (i.e. add to the</span>
    <span class="c1"># end). In this program we are only interested in reading the file.</span>
    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="c1"># The following for loop reads the lines of the file, one at a time</span>
    <span class="c1"># and executes the body of the loop once for each line of the file.</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>

        <span class="c1"># The strip method strips off the newline character at the end of the line</span>
        <span class="c1"># and any blanks that might be at the beginning or end of the line.</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># The following line splits the text variable into its pieces.</span>
        <span class="c1"># For instance, if text contained &quot;goto, 10, 20, 1, black&quot; then</span>
        <span class="c1"># commandList will be equal to [&quot;goto&quot;, &quot;10&quot;, &quot;20&quot;, &quot;1&quot;, &quot;black&quot;] after</span>
        <span class="c1"># splitting text.</span>
        <span class="n">commandList</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

        <span class="c1"># get the drawing command</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">commandList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;goto&quot;</span><span class="p">:</span>
            <span class="c1"># Writing float(commandList[1]) makes a float object out of the</span>
            <span class="c1"># string found in commandList[1]. You can do similar conversion</span>
            <span class="c1"># between types for int objects.</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">commandList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">commandList</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">commandList</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">commandList</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">t</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;circle&quot;</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">commandList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">commandList</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">commandList</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">t</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;beginfill&quot;</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">commandList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">t</span><span class="o">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">begin_fill</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;endfill&quot;</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">end_fill</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;penup&quot;</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">penup</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;pendown&quot;</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">pendown</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unknown command found in file:&quot;</span><span class="p">,</span><span class="n">command</span><span class="p">)</span>

    <span class="c1">#close the file</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1">#hide the turtle that we used to draw the picture.</span>
    <span class="n">t</span><span class="o">.</span><span class="n">ht</span><span class="p">()</span>

    <span class="c1"># This causes the program to hold the turtle graphics window open</span>
    <span class="c1"># until the mouse is clicked.</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">exitonclick</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program Execution Completed.&quot;</span><span class="p">)</span>


<span class="c1"># This code calls the main function to get everything started.</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>When you have a data file where each line of the file is its own separate
record, you can process those records as we did in <a class="reference internal" href="#graphicsprograma"><span class="std std-ref">Reading and Processing Single Line Records</span></a>. The
general pattern is to open the file, use a for loop to iterate through the file,
and have the body of the for loop process each record. The pseudo-code in
<a class="reference internal" href="#filereadingpattern"><span class="std std-ref">Pattern for Reading Single Line Records from a File</span></a> is the abstract pattern for reading one-line records
from a file.</p>
</div>
<div class="section" id="pattern-for-reading-single-line-records-from-a-file">
<span id="filereadingpattern"></span><h3>Pattern for Reading Single Line Records from a File<a class="headerlink" href="#pattern-for-reading-single-line-records-from-a-file" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># First the file must be opened.</span>
<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="c1"># The body of the for loop is executed once for each line in the file.</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
    <span class="c1"># Process each record of the file. Each record must be exactly one line of the input file.</span>
    <span class="c1"># What processing a record means will be determined by the program you are writing.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="c1"># Closing the file is always a good idea, but it will be closed when your program terminates</span>
<span class="c1"># if you do not close it explicitly.</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-multi-line-records-from-a-file">
<h2>Reading Multi-line Records from a File<a class="headerlink" href="#reading-multi-line-records-from-a-file" title="Permalink to this headline">¶</a></h2>
<p>Sometimes records of a file are not one per line. Records of a file may cross
multiple lines. In that case, you can’t use a <em>for</em> loop to read the file. You
need a <em>while</em> loop instead. When you use a while loop, you need to be able to
check a condition to see if you are done reading the file. But, to check the
condition you must first try to read at least a little of a record. This is a
kind of chicken and egg problem. Which came first, the chicken or the egg?
Computer programmers have a name for this problem as it relates to reading from
files. It is called the <em>Loop and a Half Pattern</em>. To use a while loop to read
from a file, we need a loop and a half. The half comes before the while loop.</p>
<p>Consider the program we are writing in this chapter. Let’s assume that the
records of the file cross multiple lines. In fact, let’s assume that we have
variable length records. That is, the records of our file consist of one to five
lines. The drawing commands will be exactly as they were before. But, instead of
all the data for a record appearing on one line, we’ll put each piece of data on
its own separate line as shown in <a class="reference internal" href="#multilinerecs"><span class="std std-ref">A Text File with Multiple Line Records</span></a>.</p>
<div class="section" id="a-text-file-with-multiple-line-records">
<span id="multilinerecs"></span><h3>A Text File with Multiple Line Records<a class="headerlink" href="#a-text-file-with-multiple-line-records" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>beginfill
black
circle
20
1
black
endfill
penup
goto
120
0
1
black
pendown
beginfill
black
circle
20
1
black
endfill
penup
goto
150
40
1
black
pendown
beginfill
yellow
goto
-30
40
1
black
goto
-30
70
1
black
goto
60
70
1
black
goto
60
100
1
black
goto
90
100
1
black
goto
115
70
1
black
goto
150
70
1
black
goto
150
40
1
black
endfill
</pre></div>
</div>
<p>To read a file as shown in <a class="reference internal" href="#multilinerecs"><span class="std std-ref">A Text File with Multiple Line Records</span></a> we write our loop and a half to
read the first line of each record and then check that line (i.e. the graphics
command) so we know how many more lines to read. The code in <a class="reference internal" href="#recordcode"><span class="std std-ref">Reading and Processing Multi-Line Records</span></a>
uses a while loop to read these variable length records.</p>
</div>
<div class="section" id="reading-and-processing-multi-line-records">
<span id="recordcode"></span><h3>Reading and Processing Multi-Line Records<a class="headerlink" href="#reading-and-processing-multi-line-records" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">turtle</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter drawing filename: &quot;</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">turtle</span><span class="o">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">getscreen</span><span class="p">()</span>

    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="c1"># Here we have the half a loop to get things started. Reading our first</span>
    <span class="c1"># graphics command here lets us determine if the file is empty or not.</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="c1"># If the command is empty, then there are no more commands left in the file.</span>
    <span class="k">while</span> <span class="n">command</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>

        <span class="c1"># Now we must read the rest of the record and then process it. Because</span>
        <span class="c1"># records are variable length, we&#39;ll use an if-elif to determine which</span>
        <span class="c1"># type of record it is and then we&#39;ll read and process the record.</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;goto&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">t</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;circle&quot;</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">t</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;beginfill&quot;</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">t</span><span class="o">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">begin_fill</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;endfill&quot;</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">end_fill</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;penup&quot;</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">penup</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;pendown&quot;</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">pendown</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unknown command found in file:&quot;</span><span class="p">,</span><span class="n">command</span><span class="p">)</span>

        <span class="c1"># This is still inside the while loop. We must (attempt to) read</span>
        <span class="c1"># the next command from the file. If the read succeeds, then command</span>
        <span class="c1"># will not be the empty string and the loop will be repeated. If</span>
        <span class="c1"># command is empty it is because there were no more commands in the</span>
        <span class="c1"># file and the while loop will terminate.</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>


    <span class="c1"># close the file</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">t</span><span class="o">.</span><span class="n">ht</span><span class="p">()</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">exitonclick</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program Execution Completed.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>When reading a file with multi-line records, a while loop is needed. Notice that
on line 13 the first line of the first record is read prior to the while loop.
For the body of the while loop to execute, the condition must be tested prior to
executing the loop. Reading a line prior to the while loop is necessary so we
can check to see if the file is empty or not. The first line of every other
record is read at the end of the while loop on line 55. This is the loop and a
half pattern. The first line of the first record is read before the while loop
while the first line of every other record is read inside the while loop. When
the condition becomes false, the while loop terminates.</p>
<p>The abstract pattern for reading multi-line records from a file is shown in
<a class="reference internal" href="#multilinepattern"><span class="std std-ref">Pattern for Reading Multi-line Records from a File</span></a>. There are certainly other forms of this pattern that
can be used, but memorizing this pattern is worth-while since the pattern will
work using pretty much any programming language.</p>
</div>
<div class="section" id="pattern-for-reading-multi-line-records-from-a-file">
<span id="multilinepattern"></span><h3>Pattern for Reading Multi-line Records from a File<a class="headerlink" href="#pattern-for-reading-multi-line-records-from-a-file" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># First the file must be opened</span>
<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="c1"># Read the first line of the first record in the file. Of course, firstLine should be called</span>
<span class="c1"># something that makes sense in your program.</span>
<span class="n">firstLine</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="k">while</span> <span class="n">firstLine</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="c1"># Read the rest of the record</span>
        <span class="n">secondLine</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">thirdLine</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="c1"># ...</span>

        <span class="c1"># Then process the record. This will be determined by the program you are writing.</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">firstLine</span><span class="p">,</span> <span class="n">secondLine</span><span class="p">,</span> <span class="n">thirdLine</span><span class="p">)</span>

        <span class="c1"># Finally, finish the loop by reading the first line of the next record to set up for</span>
        <span class="c1"># the next iteration of the loop.</span>
        <span class="n">firstLine</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1"># It&#39;s a good idea to close the file, but it will be automatically closed when your</span>
<span class="c1"># program terminates.</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="a-container-class">
<h2>A Container Class<a class="headerlink" href="#a-container-class" title="Permalink to this headline">¶</a></h2>
<p>To further enhance our drawing program we will first create a data structure to
hold all of our drawing commands. This is our first example of defining our own
class in this text so we’ll go slow and provide a lot of detail about what is
happening and why. To begin let’s figure out what we want to do with this
container class.</p>
<p>Our program will begin by creating an empty container. To do this, we’ll write a
line like this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graphicsCommands</span> <span class="o">=</span> <span class="n">PyList</span><span class="p">()</span>
</pre></div>
</div>
<p>Then, we will want to add graphics commands to our list using an append method
like this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">command</span> <span class="o">=</span> <span class="n">GotoCommand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
<span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</pre></div>
</div>
<p>We would also like to be able to iterate over the commands in our list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">graphicsCommands</span><span class="p">:</span>
    <span class="c1"># draw each command on the screen using the turtle called t.</span>
    <span class="n">command</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, our container class looks a lot like a list. We are defining our
own list class to illustrate a first data structure and to motivate discussion
of how lists can be implemented efficiently in this and the next chapter.</p>
</div>
<div class="section" id="polymorphism">
<h2>Polymorphism<a class="headerlink" href="#polymorphism" title="Permalink to this headline">¶</a></h2>
<p>One important concept in Object-Oriented Programming is called polymorphism. The
word <em>polymorphic</em> literally means <em>many forms</em>. As this concept is applied to
computer programming, the idea is that there can be many ways that a particular
behavior might be implemented. In relationship to our PyList container class
that we are building, the idea is that each type of graphics command will know
how to draw itself correctly. For instance, one type of graphics command is the
<em>GoToCommand</em>. When a <em>GoToCommand</em> is drawn it draws a line on the screen from
the current point to some new <em>(x,y)</em> coordinate. But, when a <em>CircleCommand</em> is
drawn, it draws a circle on the screen with a particular radius. This
<em>polymorphic</em> behavior can be defined by creating a class and draw method for
each different type of behavior. The code in <a class="reference internal" href="#graphicscommands"><span class="std std-ref">Graphics Command Classes</span></a> is a
collection of classes that define the polymorophic behavior of the different
graphics <em>draw</em> methods. There is one class for each drawing command that will
be processed by the program.</p>
<div class="section" id="graphics-command-classes">
<span id="graphicscommands"></span><h3>Graphics Command Classes<a class="headerlink" href="#graphics-command-classes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Each of the command classes below hold information for one of the</span>
<span class="c1"># types of commands found in a graphics file. For each command there must</span>
<span class="c1"># be a draw method that is given a turtle and uses the turtle to draw</span>
<span class="c1"># the object. By having a draw method for each class, we can</span>
<span class="c1"># polymorphically call the right draw method when traversing a sequence of</span>
<span class="c1"># these commands. Polymorphism occurs when the &quot;right&quot; draw method gets</span>
<span class="c1"># called without having to know which graphics command it is being called on.</span>
<span class="k">class</span> <span class="nc">GoToCommand</span><span class="p">:</span>
    <span class="c1"># Here the constructor is defined with default values for width and color.</span>
    <span class="c1"># This means we can construct a GoToCommand objects as GoToCommand(10,20),</span>
    <span class="c1"># or GoToCommand(10,20,5), or GoToCommand(10,20,5,&quot;yellow&quot;).</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CircleCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">BeginFillCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">color</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">begin_fill</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">EndFillCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># pass is a statement placeholder and does nothing. We have nothing</span>
        <span class="c1"># to initialize in this class because all we want is the polymorphic</span>
        <span class="c1"># behavior of the draw method.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">end_fill</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PenUpCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">penup</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PenDownCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">pendown</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="the-accumulator-pattern">
<h2>The Accumulator Pattern<a class="headerlink" href="#the-accumulator-pattern" title="Permalink to this headline">¶</a></h2>
<p>To use the different command classes that we have just defined, our program will
read the variable length records from the file as it did before using the <em>Loop
and a Half</em> pattern that we have already seen. Patterns of programming,
sometimes called <em>idioms</em>, are important in Computer Science. Once we have
learned an idiom we can apply it over and over in our programs. This is useful
to us because as we solve problems its nice to say, “Oh, yes, I can solve this
problem using that idiom”. Having idioms at our fingertips frees our minds to
deal with the tougher problems we encounter while programming.</p>
<p>One important pattern in programming is the <em>Accumulator Pattern</em>. This pattern
is used in nearly every program we write. When using this pattern you initialize
an accumulator before a loop and then inside the loop you add to the
accumulator. For instance, the code in <a class="reference internal" href="#sumsquares"><span class="std std-ref">Sum of Squares</span></a> uses the accumulator
pattern to compute the sum of the squares of 1 to 10.</p>
<div class="section" id="sum-of-squares">
<span id="sumsquares"></span><h3>Sum of Squares<a class="headerlink" href="#sum-of-squares" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># initialize the accumulator, in this case a list</span>
<span class="n">accumulator</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># write some kind of for loop or while loop</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># add to the accumulator, in this case add to the list</span>
    <span class="n">accumulator</span> <span class="o">=</span> <span class="n">accumulator</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>To complete our graphics program, we’ll use the loop and a half pattern to read
the records from a file and the accumulator pattern to add a command object to
our PyList container for each record we find in the file. The code is given in
<a class="reference internal" href="#completedgraphicsprog"><span class="std std-ref">A Graphics Program</span></a>.</p>
</div>
<div class="section" id="a-graphics-program">
<span id="completedgraphicsprog"></span><h3>A Graphics Program<a class="headerlink" href="#a-graphics-program" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">turtle</span>

<span class="c1"># Command classes would be inserted here but are left out because they</span>
<span class="c1"># were defined earlier in the chapter.</span>

<span class="c1"># This is our PyList class. It holds a list of our graphics</span>
<span class="c1"># commands.</span>

<span class="k">class</span> <span class="nc">PyList</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">+</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="c1"># if we want to iterate over this sequence, we define the special method</span>
    <span class="c1"># called __iter__(self). Without this we&#39;ll get &quot;builtins.TypeError:</span>
    <span class="c1"># &#39;PyList&#39; object is not iterable&quot; if we try to write</span>
    <span class="c1"># for cmd in seq:</span>
    <span class="c1"># where seq is one of these sequences. The yield below will yield an</span>
    <span class="c1"># element of the sequence and will suspend the execution of the for</span>
    <span class="c1"># loop in the method below until the next element is needed. The ability</span>
    <span class="c1"># to yield each element of the sequence as needed is called &quot;lazy&quot; evaluation</span>
    <span class="c1"># and is very powerful. It means that we only need to provide access to as</span>
    <span class="c1"># many of elements of the sequence as are necessary and no more.</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">c</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter drawing filename: &quot;</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">turtle</span><span class="o">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">getscreen</span><span class="p">()</span>
    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="c1"># Create a PyList to hold the graphics commands that are</span>
    <span class="c1"># read from the file.</span>
    <span class="n">graphicsCommands</span> <span class="o">=</span> <span class="n">PyList</span><span class="p">()</span>

    <span class="n">command</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">command</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>

        <span class="c1"># Now we must read the rest of the record and then process it. Because</span>
        <span class="c1"># records are variable length, we&#39;ll use an if-elif to determine which</span>
        <span class="c1"># type of record it is and then we&#39;ll read and process the record.</span>
        <span class="c1"># In this program, processing the record means creating a command object</span>
        <span class="c1"># using one of the classes above and then adding that object to our</span>
        <span class="c1"># graphicsCommands PyList object.</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;goto&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">GoToCommand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;circle&quot;</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">CircleCommand</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;beginfill&quot;</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">BeginFillCommand</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;endfill&quot;</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">EndFillCommand</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;penup&quot;</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenUpCommand</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;pendown&quot;</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenDownCommand</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># raising an exception will terminate the program immediately</span>
            <span class="c1"># which is what we want to happen if we encounter an unknown</span>
            <span class="c1"># command. The RuntimeError exception is a common exception</span>
            <span class="c1"># to raise. The string will be printed when the exception is</span>
            <span class="c1"># printed.</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown Command: &quot;</span> <span class="o">+</span> <span class="n">command</span><span class="p">)</span>

        <span class="c1"># Finish processing the record by adding the command to the sequence.</span>
        <span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="c1"># Read one more line to set up for the next time through the loop.</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="c1"># This code iterates through the commands to do the drawing and</span>
    <span class="c1"># demonstrates the use of the __iter(self)__ method in the</span>
    <span class="c1"># PyList class above.</span>
    <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">graphicsCommands</span><span class="p">:</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">ht</span><span class="p">()</span>
    <span class="n">screen</span><span class="o">.</span><span class="n">exitonclick</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program Execution Completed.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="implementing-a-gui-with-tkinter">
<h2>Implementing a GUI with Tkinter<a class="headerlink" href="#implementing-a-gui-with-tkinter" title="Permalink to this headline">¶</a></h2>
<p>The word GUI means Graphical User Interface. Implementing a Graphical User
Interface in Python is very easy using a module called tkinter. The Tcl/Tk
language and toolkit was designed as a cross-platform method of creating GUI
interfaces. Python provides an interface to this toolkit via the tkinter module.</p>
<p>A GUI is an event-driven program. This means that you write your code to respond
to events that occur in the program. The events occur as a result of mouse
clicks, dragging the mouse, button presses, and menu items being selected.</p>
<div class="figboxcenter docutils container">
<div class="figure align-default" id="id150">
<span id="drawpic"></span><img alt="_images/Draw800wide.png" src="_images/Draw800wide.png" />
<p class="caption"><span class="caption-number">Fig. 14 </span><span class="caption-text">The Draw Program</span><a class="headerlink" href="#id150" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>To build a GUI you place widgets in a window. Widgets are any element of a GUI
like labels, buttons, entry boxes, and sometimes invisible widgets called
frames. A frame is a widget that can hold other widgets. The drawing application
you see in <a class="reference internal" href="#drawpic"><span class="std std-numref">Fig. 14</span></a> is one such GUI built with tkinter. In this section
we’ll develop a drawing application so you learn how to create your own GUI
applications using tkinter and to improve your Python programming skills.</p>
<p>To construct a GUI you need to create a window. It is really very simple to do
this using tkinter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
</pre></div>
</div>
<p>This creates an empty window on the screen, but of course does not put anything
in it. We need to place widgets in it so it looks like the window in
<a class="reference internal" href="#drawpic"><span class="std std-numref">Fig. 14</span></a> (without the nice picture that Denise drew for us; thanks
Denise!). We also need to create event handlers to handle events in the drawing
application.</p>
<p>Putting widgets in a window is called <em>layout</em>. Laying out a window relies on a
layout manager of some sort. Windowing toolkits support some kind of layout. In
tkinter you either <em>pack</em>, <em>grid</em>, or <em>place</em> widgets within a window. When you
<em>pack</em> widgets it’s like packing a suitcase and each widget is stacked either
beside or below the previous widget packed in the GUI. Packing widgets will give
you the desired layout in most situations, but at times a <em>grid</em> may be useful
for laying out a window. The <em>place</em> layout manager lets you place widgets at a
particular location within a window. In this text, we’ll use the <em>pack</em> layout
manager to layout our drawing application.</p>
<div class="figboxcenter docutils container">
<div class="figure align-default" id="id151">
<span id="thegui"></span><img alt="_images/labelledGUI.png" src="_images/labelledGUI.png" />
<p class="caption"><span class="caption-number">Fig. 15 </span><span class="caption-text">The Draw Program Layout</span><a class="headerlink" href="#id151" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>When packing widgets, to get the proper layout, sometimes you need to create a
Frame widget. Frame widgets hold other widgets. In <a class="reference internal" href="#thegui"><span class="std std-numref">Fig. 15</span></a> two frame
widgets have been created. The DrawingApplication frame is the size of the whole
window and holds just two widgets that are placed side by side within it: the
canvas and the sideBar frame. A canvas is a widget on which a turtle can draw.
The sideBar widget holds all the buttons, entry boxes, and labels.</p>
<p>The DrawingApplication frame <em>inherits</em> from Frame. When programming in an
object-oriented language, sometimes you want to implement a class, but it is
almost like another class. In this case, the <em>DrawingApplication</em> is a <em>Frame</em>.
This means there are two parts to DrawingApplication objects, the Frame part of
the DrawingApplication and the rest of it, which in this case is the <em>PyList</em>
sequence of graphics commands. Our frame will keep track of the graphics
commands that are used to draw the picture on the canvas. Portions of the code
appear in <a class="reference internal" href="#guiapp"><span class="std std-ref">A GUI Drawing Application</span></a>. The code in <a class="reference internal" href="#guiapp"><span class="std std-ref">A GUI Drawing Application</span></a> shows you all the widgets
that are created and how they are packed within the window.</p>
<p>The <em>canvas</em> and the <em>sideBar</em> widgets are added side by side to the
DrawingApplication frame. Then all the entry, label, and button widgets are
added to the <em>sideBar</em> frame.</p>
<p>In addition, there is a menu with the <em>Draw</em> application. The menu is another
widget that is added to the window (called <em>self.master</em> in the code in
<a class="reference internal" href="#guiapp"><span class="std std-ref">A GUI Drawing Application</span></a>). The <em>fileMenu</em> is what appears on the menu bar. The menu items
“New”, “Load…”, “Load Into…”, “Save As…”, and “Exit” are all added to this
menu. Each menu item is linked to an event handler that is executed when it is
selected.</p>
<p>When <em>theTurtle</em> object is created in <a class="reference internal" href="#guiapp"><span class="std std-ref">A GUI Drawing Application</span></a>, it is created as a
<em>RawTurtle</em>. A <em>RawTurtle</em> is just like a turtle except that a <em>RawTurtle</em> can
be provided a canvas to draw on. A <em>Turtle</em> object creates its own canvas when
the first turtle is created. Since we already have a canvas for the turtle, we
create a <em>RawTurtle</em> object.</p>
<p>In addition to the event handlers for the widgets, there are three other event
handlers. The <em>onclick</em> event occurs when you click the mouse button on the
canvas. The <em>ondrag</em> event handler occurs when the turtle is dragged around the
canvas. Finally, the <em>undoHandler</em> is called when the <em>u</em> key is pressed on the
keyboard.</p>
<div class="section" id="a-gui-drawing-application">
<span id="guiapp"></span><h3>A GUI Drawing Application<a class="headerlink" href="#a-gui-drawing-application" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># This class defines the drawing application. The following line says that</span>
<span class="c1"># the DrawingApplication class inherits from the Frame class. This means that</span>
<span class="c1"># a DrawingApplication object is a Frame object with some extra information</span>
<span class="c1"># and methods.</span>
<span class="k">class</span> <span class="nc">DrawingApplication</span><span class="p">(</span><span class="n">tkinter</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span> <span class="o">=</span> <span class="n">PyList</span><span class="p">()</span>

    <span class="c1"># This method is called to create all the widgets, place them in the GUI,</span>
    <span class="c1"># and define the event handlers for the application.</span>
    <span class="k">def</span> <span class="nf">buildWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># The master is the root window. The title is set as below.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>

        <span class="c1"># Here is how to create a menu bar. The tearoff=0 means that menus</span>
        <span class="c1"># can&#39;t be separated from the window which is a feature of tkinter.</span>
        <span class="n">bar</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">fileMenu</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># This code is called by the &quot;New&quot; menu item below when it is selected.</span>
        <span class="c1"># The same applies for loadFile, addToFile, and saveFile below. The</span>
        <span class="c1"># &quot;Exit&quot; menu item below calls quit on the &quot;master&quot; or root window.</span>
        <span class="k">def</span> <span class="nf">newWindow</span><span class="p">():</span>
            <span class="c1"># This sets up the turtle to be ready for a new picture to be</span>
            <span class="c1"># drawn. It also sets the sequence back to empty. It is necessary</span>
            <span class="c1"># for the graphicsCommands sequence to be in the object (i.e.</span>
            <span class="c1"># self.graphicsCommands) because otherwise the statement:</span>
            <span class="c1"># graphicsCommands = PyList()</span>
            <span class="c1"># would make this variable a local variable in the newWindow</span>
            <span class="c1"># method. If it were local, it would not be set anymore once the</span>
            <span class="c1"># newWindow method returned.</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">penup</span><span class="p">()</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">pendown</span><span class="p">()</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span> <span class="o">=</span> <span class="n">PyList</span><span class="p">()</span>

        <span class="n">fileMenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;New&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">newWindow</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">loadFile</span><span class="p">():</span>

            <span class="n">filename</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select a Graphics File&quot;</span><span class="p">)</span>

            <span class="n">newWindow</span><span class="p">()</span>

            <span class="c1"># This re-initializes the sequence for the new picture.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span> <span class="o">=</span> <span class="n">PyList</span><span class="p">()</span>

            <span class="c1"># calling parse will read the graphics commands from the file.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="p">:</span>
                <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>

            <span class="c1"># This line is necessary to update the window after the picture is drawn.</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>


        <span class="n">fileMenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Load...&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">loadFile</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">addToFile</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select a Graphics File&quot;</span><span class="p">)</span>

            <span class="n">theTurtle</span><span class="o">.</span><span class="n">penup</span><span class="p">()</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">pendown</span><span class="p">()</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>
            <span class="n">theTurtle</span><span class="o">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenUpCommand</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">GoToCommand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenDownCommand</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="p">:</span>
                <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>

            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="n">fileMenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Load Into...&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">addToFile</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">saveFile</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Save Picture As...&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="n">fileMenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Save As...&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">saveFile</span><span class="p">)</span>


        <span class="n">fileMenu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>

        <span class="n">bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;File&quot;</span><span class="p">,</span><span class="n">menu</span><span class="o">=</span><span class="n">fileMenu</span><span class="p">)</span>

        <span class="c1"># This tells the root window to display the newly created menu bar.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="n">bar</span><span class="p">)</span>

        <span class="c1"># Here several widgets are created. The canvas is the drawing area on</span>
        <span class="c1"># the left side of the window.</span>
        <span class="n">canvas</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

        <span class="c1"># By creating a RawTurtle, we can have the turtle draw on this canvas.</span>
        <span class="c1"># Otherwise, a RawTurtle and a Turtle are exactly the same.</span>
        <span class="n">theTurtle</span> <span class="o">=</span> <span class="n">turtle</span><span class="o">.</span><span class="n">RawTurtle</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>

        <span class="c1"># This makes the shape of the turtle a circle.</span>
        <span class="n">theTurtle</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
        <span class="n">screen</span> <span class="o">=</span> <span class="n">theTurtle</span><span class="o">.</span><span class="n">getscreen</span><span class="p">()</span>

        <span class="c1"># This causes the application to not update the screen unless</span>
        <span class="c1"># screen.update() is called. This is necessary for the ondrag event</span>
        <span class="c1"># handler below. Without it, the program bombs after dragging the</span>
        <span class="c1"># turtle around for a while.</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">tracer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># This is the area on the right side of the window where all the</span>
        <span class="c1"># buttons, labels, and entry boxes are located. The pad creates some empty</span>
        <span class="c1"># space around the side. The side puts the sideBar on the right side of the</span>
        <span class="c1"># this frame. The fill tells it to fill in all space available on the right</span>
        <span class="c1"># side.</span>
        <span class="n">sideBar</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">sideBar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="c1"># This is a label widget. Packing it puts it at the top of the sidebar.</span>
        <span class="n">widthLabel</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Width&quot;</span><span class="p">)</span>
        <span class="n">widthLabel</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># This entry widget allows the user to pick a width for their lines.</span>
        <span class="c1"># With the widthSize variable below you can write widthSize.get() to get</span>
        <span class="c1"># the contents of the entry widget and widthSize.set(val) to set the value</span>
        <span class="c1"># of the entry widget to val. Initially the widthSize is set to 1. str(1) is needed</span>
        <span class="c1"># because the entry widget must be given a string.</span>
        <span class="n">widthSize</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="n">widthEntry</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="n">widthSize</span><span class="p">)</span>
        <span class="n">widthEntry</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">widthSize</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">radiusLabel</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Radius&quot;</span><span class="p">)</span>
        <span class="n">radiusLabel</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">radiusSize</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="n">radiusEntry</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="n">radiusSize</span><span class="p">)</span>
        <span class="n">radiusSize</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">radiusEntry</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c1"># A button widget calls an event handler when it is pressed. The circleHandler</span>
        <span class="c1"># function below is the event handler when the Draw Circle button is pressed.</span>
        <span class="k">def</span> <span class="nf">circleHandler</span><span class="p">():</span>
            <span class="c1"># When drawing, a command is created and then the command is drawn by calling</span>
            <span class="c1"># the draw method. Adding the command to the graphicsCommands sequence means the</span>
            <span class="c1"># application will remember the picture.</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">CircleCommand</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">radiusSize</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span> <span class="nb">int</span><span class="p">(</span><span class="n">widthSize</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span> <span class="n">penColor</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

            <span class="c1"># These two lines are needed to update the screen and to put the focus back</span>
            <span class="c1"># in the drawing canvas. This is necessary because when pressing &quot;u&quot; to undo,</span>
            <span class="c1"># the screen must have focus to receive the key press.</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

        <span class="c1"># This creates the button widget in the sideBar. The fill=tkinter.BOTH causes the</span>
        <span class="c1"># button to expand to fill the entire width of the sideBar.</span>
        <span class="n">circleButton</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Draw Circle&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">circleHandler</span><span class="p">)</span>
        <span class="n">circleButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="c1"># The color mode 255 below allows colors to be specified in RGB form (i.e. Red/</span>
        <span class="c1"># Green/Blue). The mode allows the Red value to be set by a two digit hexadecimal</span>
        <span class="c1"># number ranging from 00-FF. The same applies for Blue and Green values. The</span>
        <span class="c1"># color choosers below return a string representing the selected color and a slice</span>
        <span class="c1"># is taken to extract the #RRGGBB hexadecimal string that the color choosers return.</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">colormode</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">penLabel</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Pen Color&quot;</span><span class="p">)</span>
        <span class="n">penLabel</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">penColor</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="n">penEntry</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="n">penColor</span><span class="p">)</span>
        <span class="n">penEntry</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="c1"># This is the color black.</span>
        <span class="n">penColor</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">getPenColor</span><span class="p">():</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">colorchooser</span><span class="o">.</span><span class="n">askcolor</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">color</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">penColor</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">color</span><span class="p">)[</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">penColorButton</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Pick Pen Color&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">getPenColor</span><span class="p">)</span>
        <span class="n">penColorButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="n">fillLabel</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Fill Color&quot;</span><span class="p">)</span>
        <span class="n">fillLabel</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">fillColor</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="n">fillEntry</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="n">fillColor</span><span class="p">)</span>
        <span class="n">fillEntry</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">fillColor</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">getFillColor</span><span class="p">():</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">colorchooser</span><span class="o">.</span><span class="n">askcolor</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">color</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fillColor</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">color</span><span class="p">)[</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">fillColorButton</span> <span class="o">=</span> \
            <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Pick Fill Color&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">getFillColor</span><span class="p">)</span>
        <span class="n">fillColorButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">beginFillHandler</span><span class="p">():</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">BeginFillCommand</span><span class="p">(</span><span class="n">fillColor</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="n">beginFillButton</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Begin Fill&quot;</span><span class="p">,</span> \
                          <span class="n">command</span><span class="o">=</span><span class="n">beginFillHandler</span><span class="p">)</span>
        <span class="n">beginFillButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">endFillHandler</span><span class="p">():</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">EndFillCommand</span><span class="p">()</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="n">endFillButton</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;End Fill&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">endFillHandler</span><span class="p">)</span>
        <span class="n">endFillButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="n">penLabel</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Pen Is Down&quot;</span><span class="p">)</span>
        <span class="n">penLabel</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">penUpHandler</span><span class="p">():</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenUpCommand</span><span class="p">()</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="n">penLabel</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Pen Is Up&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="n">penUpButton</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Pen Up&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">penUpHandler</span><span class="p">)</span>
        <span class="n">penUpButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">penDownHandler</span><span class="p">():</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenDownCommand</span><span class="p">()</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="n">penLabel</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Pen Is Down&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="n">penDownButton</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sideBar</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Pen Down&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">penDownHandler</span><span class="p">)</span>
        <span class="n">penDownButton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>

        <span class="c1"># Here is another event handler. This one handles mouse clicks on the screen.</span>
        <span class="k">def</span> <span class="nf">clickHandler</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
            <span class="c1"># When a mouse click occurs, get the widthSize entry value and set the width of the</span>
            <span class="c1"># pen to the widthSize value. The int(widthSize.get()) is needed because</span>
            <span class="c1"># the width is an integer, but the entry widget stores it as a string.</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">GoToCommand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">widthSize</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span><span class="n">penColor</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

        <span class="c1"># Here is how we tie the clickHandler to mouse clicks.</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">onclick</span><span class="p">(</span><span class="n">clickHandler</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">dragHandler</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">GoToCommand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">widthSize</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span><span class="n">penColor</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="n">screen</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

        <span class="n">theTurtle</span><span class="o">.</span><span class="n">ondrag</span><span class="p">(</span><span class="n">dragHandler</span><span class="p">)</span>

        <span class="c1"># the undoHandler undoes the last command by removing it from the</span>
        <span class="c1"># sequence and then redrawing the entire picture.</span>
        <span class="k">def</span> <span class="nf">undoHandler</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="o">.</span><span class="n">removeLast</span><span class="p">()</span>
                <span class="n">theTurtle</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">theTurtle</span><span class="o">.</span><span class="n">penup</span><span class="p">()</span>
                <span class="n">theTurtle</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">theTurtle</span><span class="o">.</span><span class="n">pendown</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="p">:</span>
                    <span class="n">cmd</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">theTurtle</span><span class="p">)</span>
                <span class="n">screen</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="n">screen</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

        <span class="n">screen</span><span class="o">.</span><span class="n">onkeypress</span><span class="p">(</span><span class="n">undoHandler</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">)</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

<span class="c1"># The main function in our GUI program is very simple. It creates the</span>
<span class="c1"># root window. Then it creates the DrawingApplication frame which creates</span>
<span class="c1"># all the widgets and has the logic for the event handlers. Calling mainloop</span>
<span class="c1"># on the frames makes it start listening for events. The mainloop function will</span>
<span class="c1"># return when the application is exited.</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
    <span class="n">drawingApp</span> <span class="o">=</span> <span class="n">DrawingApplication</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="n">drawingApp</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program Execution Completed.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xml-files">
<h2>XML Files<a class="headerlink" href="#xml-files" title="Permalink to this headline">¶</a></h2>
<p>Reading a standard text file, like the graphics commands file we read using the
loop and a half pattern in <a class="reference internal" href="#completedgraphicsprog"><span class="std std-ref">A Graphics Program</span></a>, is a common task in
computer programs. The only problem is that the program must be written to read
the specific format of the input file. If we later wish to change the format of
the input file to include, for example, a new option like fill color for a
circle, then we are stuck updating the program and updating all the files it
once read. The input file format and the program must always be synchronized.
This means that all old formatted input files must be converted to the new
format or they must be thrown away. That is simply not acceptable to most
businesses because data is valuable.</p>
<p>To deal with this problem, computer programmers designed a language for
describing data input files called XML which stands for eXtensible Markup
Language. XML is a meta-language for data description. A meta-language is a
language for describing other languages. The XML meta-language is universally
accepted. In fact, the XML format is governed by a standards committee, which
means that we can count on the XML format remaining very stable and backwards
compatible forever. Any additions to XML will have to be compatible with what
has already been defined.</p>
<p>An XML document begins with a special line to identify it as an XML file. This
line looks like this.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;</span>
</pre></div>
</div>
<p>The rest of an XML file consists of elements or nodes. Each node is identified
by a tag or a pair of beginning and ending tags. Each tag is delimited (i.e.
surrounded) by angle brackets. For instance, here is one such tag.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;GraphicsCommands&gt;</span>
</pre></div>
</div>
<p>Most XML elements are delimited by a opening tag and a closing tag. The tag
above is an opening tag. Its matching closing tag looks like this.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;/GraphicsCommands&gt;</span>
</pre></div>
</div>
<p>The slash just before the tag name means that it is a closing tag. An opening
and closing tag may have text or other XML elements in between the two tags so
XML documents may contain XML elements nested as deeply as necessary depending
on the data you are trying to encode.</p>
<p>Each XML element may have attributes associated with it. For instance, consider
an XML element that encapsulates the information needed to do a <em>GoTo</em> graphics
command. To complete a <em>GoTo</em> command we need the <em>x</em> and <em>y</em> coordinates, the
<em>width</em> of the line, and the pen <em>color</em>. Here is an example of encoding that
information in XML format.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;1.0&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;#000000&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
</pre></div>
</div>
<p>In this example the attributes are <em>x</em>, <em>y</em>, <em>width</em>, and <em>color</em>. Each
attribute is mapped to its value as shown above. The <em>GoTo</em> text is the text
that appears between the opening and closing tags. That text is sometimes called
the child data.</p>
<p>By encoding an entire graphics commands input file in XML format we eliminate
some of the dependence between the Draw <em>program</em> and its <em>data</em>. Except for the
XML format (i.e. the grammar) the contents of the XML file are completely up to
the programmer or programmers using the data. The file in <a class="reference internal" href="#truckxml"><span class="std std-ref">The Truck XML File</span></a> is an
example of the truck picture’s XML input file.</p>
<div class="section" id="the-truck-xml-file">
<span id="truckxml"></span><h3>The Truck XML File<a class="headerlink" href="#the-truck-xml-file" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;</span>
<span class="nt">&lt;GraphicsCommands&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>BeginFill<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">radius=</span><span class="s">&quot;20.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>Circle<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>EndFill<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>PenUp<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;120.0&quot;</span> <span class="na">y=</span><span class="s">&quot;0.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>PenDown<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>BeginFill<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">radius=</span><span class="s">&quot;20.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>Circle<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>EndFill<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>PenUp<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;150.0&quot;</span> <span class="na">y=</span><span class="s">&quot;40.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>PenDown<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">color=</span><span class="s">&quot;yellow&quot;</span><span class="nt">&gt;</span>BeginFill<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;-30.0&quot;</span> <span class="na">y=</span><span class="s">&quot;40.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;-30.0&quot;</span> <span class="na">y=</span><span class="s">&quot;70.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;60.0&quot;</span> <span class="na">y=</span><span class="s">&quot;70.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;60.0&quot;</span> <span class="na">y=</span><span class="s">&quot;100.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;90.0&quot;</span> <span class="na">y=</span><span class="s">&quot;100.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;115.0&quot;</span> <span class="na">y=</span><span class="s">&quot;70.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;150.0&quot;</span> <span class="na">y=</span><span class="s">&quot;70.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command</span> <span class="na">x=</span><span class="s">&quot;150.0&quot;</span> <span class="na">y=</span><span class="s">&quot;40.0&quot;</span> <span class="na">width=</span><span class="s">&quot;1.0&quot;</span> <span class="na">color=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>GoTo<span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;Command&gt;</span>EndFill<span class="nt">&lt;/Command&gt;</span>
<span class="nt">&lt;/GraphicsCommands&gt;</span>
</pre></div>
</td></tr></table></div>
<p>XML files are text files. They just contain extra XML formatted data to help
standardize how XML files are read. Writing an XML file is as simple as writing
a text file. While indentation is not necessary in XML files, it is often used
to highlight the format of the file. In <a class="reference internal" href="#truckxml"><span class="std std-ref">The Truck XML File</span></a> the <em>GraphicsCommands</em>
element contains one <em>Command</em> element for each drawing command in the picture.
Each drawing command contains the command type as its text. The command types
are <em>GoTo</em>, <em>Circle</em>, <em>BeginFill</em>, <em>EndFill</em>, <em>PenUp</em>, and <em>PenDown</em>. The
attributes of a command are data like <em>x</em>, <em>y</em>, <em>width</em>, <em>radius</em>, and <em>color</em>
that are used by the various types of commands.</p>
<p>To write the commands to a file, each of the Command classes can be modified to
produce an XML element when converted to a string using the special <em>__str__</em>
method. For instance, <a class="reference internal" href="#gotoxml"><span class="std std-ref">The GoToCommand with XML Creation Code</span></a> contains the modified GoToCommand class
supporting the creation of an XML element.</p>
</div>
<div class="section" id="the-gotocommand-with-xml-creation-code">
<span id="gotoxml"></span><h3>The GoToCommand with XML Creation Code<a class="headerlink" href="#the-gotocommand-with-xml-creation-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># The following classes define the different commands that</span>
<span class="c1"># are supported by the drawing application.</span>
<span class="k">class</span> <span class="nc">GoToCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="c1"># The draw method for each command draws the command</span>
    <span class="c1"># using the given turtle</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">turtle</span><span class="p">):</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="n">turtle</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># The __str__ method is a special method that is called</span>
    <span class="c1"># when a command is converted to a string. The string</span>
    <span class="c1"># version of the command is how it appears in the graphics</span>
    <span class="c1"># file format.</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;Command x=&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; y=&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; width=&quot;&#39;</span> <span class="o">+</span>  \
               <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; color=&quot;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;GoTo&lt;/Command&gt;&#39;</span>
</pre></div>
</td></tr></table></div>
<p>By returning a string like this from each of the command objects, the code to
write the draw program’s data to a file is very simple. All that is needed is
some code that writes the <em>xml</em> line as the first line, followed by the
<em>&lt;GraphicsCommands&gt;</em> tag and the command elements. Finally, the
<em>&lt;/GraphicsCommands&gt;</em> tag must be written. The code in <a class="reference internal" href="#writingxml"><span class="std std-ref">Writing Graphics Commands to an XML File</span></a>
accomplishes this.</p>
</div>
<div class="section" id="writing-graphics-commands-to-an-xml-file">
<span id="writingxml"></span><h3>Writing Graphics Commands to an XML File<a class="headerlink" href="#writing-graphics-commands-to-an-xml-file" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;GraphicsCommands&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicsCommands</span><span class="p">:</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/GraphicsCommands&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Writing an XML file is like writing any text file except that the text file must
conform to the XML grammar specification. There are certainly ways to create XML
files that differ from how it was presented in <a class="reference internal" href="#writingxml"><span class="std std-ref">Writing Graphics Commands to an XML File</span></a>. In the next
section we’ll learn about XML parsers and a very simple way to read XML
documents. It turns out there are at least some XML frameworks that make writing
an XML document just as simple.</p>
</div>
</div>
<div class="section" id="reading-xml-files">
<h2>Reading XML Files<a class="headerlink" href="#reading-xml-files" title="Permalink to this headline">¶</a></h2>
<p>XML files would be difficult to read if we had to read them like we read a
regular text file. This is especially true because XML files are not
line-oriented. They conform to the XML grammar, but the grammar does not specify
anything about the lines in the file. Instead of reading an XML file by reading
lines of the file, we use a special tool called a <em>parser</em>. A <em>parser</em> is
written according to the rules of a <em>grammar</em>, in this case the XML grammar.
There are many XML parsers that have been written and different parsers have
different features. The one we will use in this text is one of the simpler
parsers called <em>minidom</em>. The <em>minidom</em> parser reads an entire XML file by
calling the <em>parse</em> method on it. It places the entire contents of an XML file
into an sequence of <em>Element</em> objects. An <em>Element</em> object contains the child
data and attributes of an XML element along with any other elements that might
be defined inside this element.</p>
<p>To use the minidom parser, you must first import the module where the minidom
parser is defined.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xml.dom.minidom</span>
</pre></div>
</div>
<p>Then, you can read an entire XML file by calling the <em>parse</em> method on an XML
document as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xmldoc</span> <span class="o">=</span> <span class="n">xml</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">minidom</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>Once you have done that, you can read a specific type of element from the XML
file by calling the method <em>getElementsByTagName</em> on it. For instance, to get
the <em>GraphicsCommands</em> element from the graphics commands XML file, you would
write this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graphicsCommands</span> <span class="o">=</span> <span class="n">xmldoc</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;GraphicsCommands&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>The XML document contains the GraphicsCommands element. Calling
<em>getElementsByTagName</em> on <em>GraphicsCommands</em> returns a list of all tags that
match this tag name. Since we know there is only one of these tags in the file,
we can write <em>[0]</em> to get the first element from the list. Then, the
<em>graphicsCommands</em> element contains just the one element from the file and all
the <em>Command</em> elements of the file are located within it. If we want to go
through all these elements we can use a for loop as in the code in
<a class="reference internal" href="#usingxmlparser"><span class="std std-ref">Using an XML Parser</span></a>.</p>
<div class="section" id="using-an-xml-parser">
<span id="usingxmlparser"></span><h3>Using an XML Parser<a class="headerlink" href="#using-an-xml-parser" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">commandElement</span> <span class="ow">in</span> <span class="n">graphicsCommands</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">commandElement</span><span class="p">))</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">commandElement</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">attr</span> <span class="o">=</span> <span class="n">commandElement</span><span class="o">.</span><span class="n">attributes</span>
    <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;GoTo&quot;</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">attr</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">GoToCommand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;Circle&quot;</span><span class="p">:</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">attr</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">CircleCommand</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;BeginFill&quot;</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">attr</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">BeginFillCommand</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;EndFill&quot;</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">EndFillCommand</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;PenUp&quot;</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenUpCommand</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;PenDown&quot;</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">PenDownCommand</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown Command: &quot;</span> <span class="o">+</span> <span class="n">command</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>In the code in <a class="reference internal" href="#usingxmlparser"><span class="std std-ref">Using an XML Parser</span></a> the <em>attr</em> variable is a dictionary mapping
the attribute <em>names</em> (i.e. keys) to their associated <em>values</em>. The child data
of a <em>Command</em> node can be found by looking at the <em>firstChild.data</em> for the
node. The <em>strip</em> method is used to strip away any unwanted blanks, tabs, or
newline characters that might appear in the string.</p>
</div>
</div>
<div class="section" id="id21">
<h2>Chapter Summary<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<p>In this first chapter we have covered a large amount of material which should be
mostly review but probably covered some things that are new to you as well.
Don’t be too overwhelmed by it all. The purpose of this chapter is to get you
asking questions about the things you don’t understand. If you don’t understand
something, you should ask your teacher or someone who knows more about
programming in Python. They can likely help you. Asking questions is a great way
to learn and Computer Science is all about a lifetime of learning.</p>
<p>Here is a list of the important concepts you should have learned in this chapter. You should:</p>
<blockquote>
<div><ul class="simple">
<li><p>know how to use the <em>Wing IDE</em> or a similar IDE to run and debug a program.
If you haven’t taken the time yet, watch an online video on how to use the
Wing IDE. It will be a valuable tool for you while reading this text.</p></li>
<li><p>know how to create an <em>object</em>, both from a literal value and by calling the
object’s constructor explicitly.</p></li>
<li><p>understand the concept of a <em>reference</em> pointing at a value (i.e. an object)
in Python.</p></li>
<li><p>know how to call a <em>method</em> on an object.</p></li>
<li><p>how to <em>import</em> a module.</p></li>
<li><p>understand the importance of <em>indentation</em> in Python programs.</p></li>
<li><p>know why you write a <em>main</em> function in Python program’s and how to call the
main function.</p></li>
<li><p>know how to read records from a file whether they be multi-line, single line,
fixed length, or variable length records.</p></li>
<li><p>know how to define a <em>container</em> class like PyList defined in this chapter.</p></li>
<li><p>understand the concept of <em>polymporphism</em> and how that means an object will
do the right thing when a method is called.</p></li>
<li><p>understand the <em>Accumulator</em> pattern and how to use it in a program.</p></li>
<li><p>know how to implement a simple GUI using tkinter in Python. Entry boxes,
labels, buttons, frames, and event handlers should all be concepts that are
understood and can be programmed by looking back at the examples in this
chapter.</p></li>
<li><p>and finally you should know how to read and write XML files in your programs.</p></li>
</ul>
</div></blockquote>
<p>There is a lot of example code in this chapter and the final version of the
<em>Draw</em> program is
<a class="reference external" href="https://kentdlee.github.io/CS2Plus/build/html/chap1/chap1.html#the-final-xml-draw-program">provided here</a>.
While it is doubtful you will be able to memorize each line of the code you
found in this chapter, you should make sure you know how things work when you
look at it and you should remember that you can use this chapter as a resource.
Come back to it often when you need to see how to do something in later
chapters. Using this example code as a reference will help to answer a lot of
your questions in future chapters.</p>
</div>
<div class="section" id="id22">
<h2>Review Questions<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h2>
<p>Answer these short answer, multiple choice, and true/false questions to test
your mastery of the chapter.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>What does IDE stand for and why is it a good idea to use an IDE?</p></li>
<li><p>What code would you write to create a string containing the words <em>Happy
Birthday!</em>? Write some code to point a reference called <em>text</em> at that newly
created object.</p></li>
<li><p>What code would you write to take the string you created in the last
question and split it into a list containing two strings? Point the reference
<em>lst</em> at this newly created list.</p></li>
<li><p>What code would you write to upper-case the string created in the second
question. Point the reference named <em>bDayWish</em> at this upper-cased string.</p></li>
<li><p>If you were to execute the code you wrote for answering the last three
questions, what would the string referenced by <em>text</em> contain after executing
these three lines of code?</p></li>
<li><p>How would you create a dictionary that maps “Kent” to “Denise” and maps
“Steve” to “Lindy”? In these two cases “Kent” and “Steve” are the keys and
“Denise” and “Lindy” are the values.</p></li>
<li><p>Consult
<a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">the dictionary reference</a>.
How would you map a key to a value as in the previous problem when the
dictionary was first created as an empty dictionary? HINT: This would be called
setting an item in the documentation in the appendix. Write a short piece of
code to create an empty dictionary and then map “Kent” to “Denise” and “Steve”
to “Lindy”.</p></li>
<li><p>What method is called when <em>x&lt;y</em> is written? In which class is the method a
member? In other words, if you were presented with <em>x&lt;y</em> in a program, how
would you figure out which class you needed to examine to understand exactly
what <em>x&lt;y</em> meant?</p></li>
<li><p>What method is called when <em>x&lt;&lt;y</em> is written?</p></li>
<li><p>What is the loop and a half problem and how is it solved?</p></li>
<li><p>Do you need to use the solution to the loop and a half problem to read an
XML file? Why or why not?</p></li>
<li><p>Polymorphism and Operator Overloading are closely related concepts. Can you
briefly explain how the two concepts are similar and how Python supports them?
HINT: No is not a valid answer.</p></li>
<li><p>What would you write so that a program asks the user to enter an integer and
then adds up all the even integers from 2 to the integer entered by the user.
HINT: You might want to review how to use the <em>range</em> function to accomplish
this and decide on what pattern of programming you might use.</p></li>
<li><p>How do you create a window using tkinter?</p></li>
<li><p>What is the purpose of a Frame object in a tkinter program?</p></li>
<li><p>What are three types of widgets in the tkinter framework?</p></li>
<li><p>When reading an XML file, how many lines of code does it take to read the
file?</p></li>
<li><p>How do you get a single element from an XML document? What line(s) of code
do you have to write? Provide an example.</p></li>
<li><p>When traversing an XML document, how do you get a list of elements from it?
What line(s) of code do you have to write? Provide an example.</p></li>
<li><p>What is an attribute in an XML document and how do you access an attribute’s
value? Provide an example from the text or from another example you find
online.</p></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="programming-problems">
<h2>Programming Problems<a class="headerlink" href="#programming-problems" title="Permalink to this headline">¶</a></h2>
<p>These programming problems will give you a chance to try out the code found in this chapter and expand on those examples in one way or another.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Starting with the version of the <em>Draw</em> program that reads an input file
with variable length records, add a new graphics command of your choice to the
program. Consider how it would be written to a file, create a test file, write
your code, and test it. You must design two files: a sample test file, and the
program itself. Some examples might be a graphics command to draw a star with
some number of points, a rectangle with a height and width, etc.</p></li>
<li><p>Starting with the <em>Draw</em> program
<a class="reference external" href="https://kentdlee.github.io/CS2Plus/build/html/chap1/chap1.html#the-final-xml-draw-program">provided here</a>,
extend the program to include a new button to draw a new shape for the <em>Draw</em>
program. For instance, have the draw program draw a star on the screen or a
smiley face or something of your choosing. HINT: If you use forward, and back
to draw your shape, you can scale it by multiplying each forward and back
amount by a scale value. Then, you can let the user pick a scale for it (or use
the radius amount as your scale) and draw your shape in whatever size you like.
To complete this exercise you must extend your XML format to include a new
graphics command to store the relative information for drawing your new shape.
You must also define a new graphicsCommand class for your new shape.</p></li>
<li><p>Add the ability to draw a text string on a <em>Draw</em> picture. You’ll need to
let the user pick a point size. For a real challenge, let the user pick the
font type from a drop-down list of font types. Draw a string that you have the
user enter in an entry box.</p></li>
<li><p>Find an XML document of your choice on the internet, write code to parse
through the data and plot something from that data whether it be some value
over time or something else. Use turtle graphics to plot the data that you
find.</p></li>
<li><p>Add a new button to the drawing program
<a class="reference external" href="https://kentdlee.github.io/CS2Plus/build/html/chap1/chap1.html#the-final-xml-draw-program">presented here</a>
that draws a rainbow centered above the current location of the turtle. This
can be done quite easily by using <em>sin</em> and <em>cos</em> (i.e. sine and cosine). The
<em>sin</em> and <em>cos</em> functions take radians as a parameter. To draw a rainbow, the
radians would range from 0 to <em>math.pi</em> from the math module. You must import
the <em>math</em> module to get access to <em>math.cos</em> and <em>math.sin</em> as well as
<em>math.pi</em>. To draw values in an arc, you can use a <em>for loop</em> and let a
variable, <em>i</em>, range from 0 to 100. Then <em>radius * math.cos(i/100.0 *
math.pi)</em>, <em>radius * math.sin(i/100.0 * math.pi)</em> is the next <em>x,y</em> coordinate
of the rainbow’s arc. By varying the radius you will get several stripes for
your rainbow. Each stripe should have a different color. To vary the color, you
might convert a 24-bit number to hex. To convert a number to hexadecimal in
Python you can use the <em>hex</em> function. You must make sure that your color
string is 6 digits long and starts with a pound sign (i.e. #) for it to be a
valid color string in Python.</p></li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="chapter-4-programming-models">
<h1>Chapter 4: Programming Models<a class="headerlink" href="#chapter-4-programming-models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-run-time-stack-and-heap">
<h2>The Run-time Stack and Heap<a class="headerlink" href="#the-run-time-stack-and-heap" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="critical-sections">
<h2>Critical Sections<a class="headerlink" href="#critical-sections" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="thread-based-parallelism">
<h2>Thread-based Parallelism<a class="headerlink" href="#thread-based-parallelism" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="process-based-parallelism">
<h2>Process-based Parallelism<a class="headerlink" href="#process-based-parallelism" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="locks">
<h2>Locks<a class="headerlink" href="#locks" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="queues">
<h2>Queues<a class="headerlink" href="#queues" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="chapter-5-c-programming">
<h1>Chapter 5: C Programming<a class="headerlink" href="#chapter-5-c-programming" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fundamental-types">
<h2>Fundamental Types<a class="headerlink" href="#fundamental-types" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Pass by value.</p>
</div>
<div class="section" id="pointers">
<h2>Pointers<a class="headerlink" href="#pointers" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="arrays">
<h2>Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="strings">
<h2>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="fork-join">
<h2>Fork/Join<a class="headerlink" href="#fork-join" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="atomic-instructions">
<h2>Atomic Instructions<a class="headerlink" href="#atomic-instructions" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="chapter-6-posix">
<h1>Chapter 6: POSIX<a class="headerlink" href="#chapter-6-posix" title="Permalink to this headline">¶</a></h1>
<div class="section" id="message-queues">
<h2>Message Queues<a class="headerlink" href="#message-queues" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="semaphores">
<h2>Semaphores<a class="headerlink" href="#semaphores" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="the-futex">
<h2>The Futex<a class="headerlink" href="#the-futex" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="shared-memory">
<h2>Shared Memory<a class="headerlink" href="#shared-memory" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="chapter-7-shared-memory">
<h1>Chapter 7: Shared Memory<a class="headerlink" href="#chapter-7-shared-memory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id24">
<h2>Locks<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id25">
<h2>Queues<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="chapther-8-distributed-multprocessing">
<h1>Chapther 8: Distributed Multprocessing<a class="headerlink" href="#chapther-8-distributed-multprocessing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id26">
<h2>Locks<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id27">
<h2>Queues<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="serialization">
<h2>Serialization<a class="headerlink" href="#serialization" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="proxies">
<h2>Proxies<a class="headerlink" href="#proxies" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="libraries">
<h2>Libraries<a class="headerlink" href="#libraries" title="Permalink to this headline">¶</a></h2>
<p>MPI, PMI.</p>
</div>
</div>
<div class="section" id="chapter-9-python-multiprocessing">
<h1>Chapter 9: Python Multiprocessing<a class="headerlink" href="#chapter-9-python-multiprocessing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-gil">
<h2>The GIL<a class="headerlink" href="#the-gil" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="process">
<h2>Process<a class="headerlink" href="#process" title="Permalink to this headline">¶</a></h2>
<p>What happens in Python to start a process</p>
</div>
<div class="section" id="id28">
<h2>Locks<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="managers">
<h2>Managers<a class="headerlink" href="#managers" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id29">
<h2>Queues<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="pool">
<h2>Pool<a class="headerlink" href="#pool" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="map">
<h2>Map<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="starmap">
<h2>Starmap<a class="headerlink" href="#starmap" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="chapter-10-cython">
<h1>Chapter 10: Cython<a class="headerlink" href="#chapter-10-cython" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<div class="docutils container" id="id30">
<dl class="citation">
<dt class="label" id="id53"><span class="brackets">Gor15</span><span class="fn-backref">(<a href="#id12">1</a>,<a href="#id13">2</a>)</span></dt>
<dd><p>Steve Gordon. <em>Driving in the Fast Lane - CPU Pinning and NUMA Topology Awareness in OpenStack Compute</em>. Redhat Blog, 2015. URL: <a class="reference external" href="https://www.redhat.com/en/blog/driving-fast-lane-cpu-pinning-and-numa-topology-awareness-openstack-compute">https://www.redhat.com/en/blog/driving-fast-lane-cpu-pinning-and-numa-topology-awareness-openstack-compute</a>.</p>
</dd>
<dt class="label" id="id132"><span class="brackets"><a class="fn-backref" href="#id2">Kub20</a></span></dt>
<dd><p>Ralph Kube. Moving fusion research into the big-and-fast data lane. Technical Report, DOE, 2020. URL: <a class="reference external" href="https://theory.pppl.gov/research/DOE%20Highlights/2020/DOEhighlight20200729Kube.pdf">https://theory.pppl.gov/research/DOE%20Highlights/2020/DOEhighlight20200729Kube.pdf</a>.</p>
</dd>
<dt class="label" id="id131"><span class="brackets"><a class="fn-backref" href="#id1">LtKT95</a></span></dt>
<dd><p>G. S. Lee and the KSTAR Team. Design and construction of the kstar tokamak. Technical Report, National Fusion R&amp;D Center, Korea Basic Science Institute, Taejon, Republic of Korea, 1995. URL: <a class="reference external" href="https://www.osti.gov/etdeweb/servlets/purl/20261539">https://www.osti.gov/etdeweb/servlets/purl/20261539</a>.</p>
</dd>
<dt class="label" id="id133"><span class="brackets"><a class="fn-backref" href="#id4">MRK+17</a></span></dt>
<dd><p>P. J. Mendygral, N. Radcliffe, K. Kandalla, D. Porter, B. J. O'Neill, C. Nolting, P. Edmon, J. M. F. Donnert, and T. W. Jones. WOMBAT: a scalable and high-performance astrophysical magnetohydrodynamics code. <em>The Astrophysical Journal Supplement Series</em>, 228(2):23, feb 2017. URL: <a class="reference external" href="https://doi.org/10.3847%2F1538-4365%2Faa5b9c">https://doi.org/10.3847%2F1538-4365%2Faa5b9c</a>, <a class="reference external" href="https://doi.org/10.3847/1538-4365/aa5b9c">doi:10.3847/1538-4365/aa5b9c</a>.</p>
</dd>
<dt class="label" id="id50"><span class="brackets"><a class="fn-backref" href="#id18">Mor19</a></span></dt>
<dd><p>Timothy Prickett Morgan. How cray makes ethernet suited for hpc and ai with slingshot. <em>The Next Platform</em>, 2019. URL: <a class="reference external" href="https://www.nextplatform.com/2019/08/16/how-cray-makes-ethernet-suited-for-hpc-and-ai-with-slingshot">https://www.nextplatform.com/2019/08/16/how-cray-makes-ethernet-suited-for-hpc-and-ai-with-slingshot</a>.</p>
</dd>
<dt class="label" id="id51"><span class="brackets">Mor22</span><span class="fn-backref">(<a href="#id16">1</a>,<a href="#id17">2</a>)</span></dt>
<dd><p>Timothy Prickett Morgan. On the shortest spanning tree of a graph and the traveling salesman problem. <em>The Next Platform</em>, 2022. URL: <a class="reference external" href="https://www.nextplatform.com/2022/01/31/crays-slingshot-interconnect-is-at-the-heart-of-hpes-hpc-and-ai-ambitions">https://www.nextplatform.com/2022/01/31/crays-slingshot-interconnect-is-at-the-heart-of-hpes-hpc-and-ai-ambitions</a>.</p>
</dd>
<dt class="label" id="id46"><span class="brackets"><a class="fn-backref" href="#id10">Ost22</a></span></dt>
<dd><p>Igor Ostrovsky. <em>Gallery of Processor Cache Effects</em>. Igor Ostrovsky, accessed 2022. URL: <a class="reference external" href="http://igoro.com/archive/gallery-of-processor-cache-effects/">http://igoro.com/archive/gallery-of-processor-cache-effects/</a>.</p>
</dd>
<dt class="label" id="id136"><span class="brackets"><a class="fn-backref" href="#id7">PH98</a></span></dt>
<dd><p>David A. Patterson and John L. Hennessy. <em>Computer Organization and Design</em>. Morgan Kaufmann Publishers, 2nd edition, 1998. ISBN 15-586-0428-6.</p>
</dd>
<dt class="label" id="id134"><span class="brackets"><a class="fn-backref" href="#id3">Rog00</a></span></dt>
<dd><p><em>COMPUTATION OF VISCOUS FLOW FOR A BOEING 777 AIRCRAFT IN LANDING CONFIGURATION</em>, 2000. URL: <a class="reference external" href="https://tinyurl.com/2vvp8473">https://tinyurl.com/2vvp8473</a>.</p>
</dd>
<dt class="label" id="id47"><span class="brackets"><a class="fn-backref" href="#id9">Web22</a></span></dt>
<dd><p>System Verilog Website. <em>DDR4 SDRAM - Understanding Timing Parameters</em>. Systemverilog.io, accessed 2022. URL: <a class="reference external" href="https://www.systemverilog.io/understanding-ddr4-timing-parameters">https://www.systemverilog.io/understanding-ddr4-timing-parameters</a>.</p>
</dd>
<dt class="label" id="id44"><span class="brackets"><a class="fn-backref" href="#id11">Wik22a</a></span></dt>
<dd><p>Wikipedia. <em>Cache coherence</em>. Wikipedia.org, accessed 2022. URL: <a class="reference external" href="https://en.wikipedia.org/wiki/Cache_coherence">https://en.wikipedia.org/wiki/Cache_coherence</a>.</p>
</dd>
<dt class="label" id="id42"><span class="brackets"><a class="fn-backref" href="#id15">Wik22b</a></span></dt>
<dd><p>Wikipedia. <em>Frontier (supercomputer)</em>. Wikipedia.org, accessed 2022. URL: <a class="reference external" href="https://en.wikipedia.org/wiki/Frontier_(supercomputer)">https://en.wikipedia.org/wiki/Frontier_(supercomputer)</a>.</p>
</dd>
<dt class="label" id="id43"><span class="brackets"><a class="fn-backref" href="#id8">Wik22c</a></span></dt>
<dd><p>Wikipedia. <em>Memory timings</em>. Wikipedia.org, accessed 2022. URL: <a class="reference external" href="https://en.wikipedia.org/wiki/Memory_timings">https://en.wikipedia.org/wiki/Memory_timings</a>.</p>
</dd>
<dt class="label" id="id45"><span class="brackets"><a class="fn-backref" href="#id14">Wik22d</a></span></dt>
<dd><p>Wikipedia. <em>SHMEM</em>. Wikipedia.org, accessed 2022. URL: <a class="reference external" href="https://en.wikipedia.org/wiki/SHMEM">https://en.wikipedia.org/wiki/SHMEM</a>.</p>
</dd>
<dt class="label" id="id41"><span class="brackets"><a class="fn-backref" href="#id6">Wik22e</a></span></dt>
<dd><p>Wikipedia. <em>Von Neumann architecture</em>. Wikipedia.org, accessed 2022. URL: <a class="reference external" href="https://en.wikipedia.org/wiki/Von_Neumann_architecture">https://en.wikipedia.org/wiki/Von_Neumann_architecture</a>.</p>
</dd>
<dt class="label" id="id135"><span class="brackets"><a class="fn-backref" href="#id5">You18</a></span></dt>
<dd><p>Anthony Young. Lessons from alpha zero (part 5): performance optimization. <em>Medium.com</em>, 2018. URL: <a class="reference external" href="https://medium.com/oracledevs/lessons-from-alpha-zero-part-5-performance-optimization-664b38dc509e">https://medium.com/oracledevs/lessons-from-alpha-zero-part-5-performance-optimization-664b38dc509e</a>.</p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kent D. Lee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>